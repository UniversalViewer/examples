(window.webpackJsonpUV=window.webpackJsonpUV||[]).push([[2],{35:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.BOOKMARKING="oa:bookmarking",t.CLASSIFYING="oa:classifying",t.COMMENTING="oa:commenting",t.DESCRIBING="oa:describing",t.EDITING="oa:editing",t.HIGHLIGHTING="oa:highlighting",t.IDENTIFYING="oa:identifying",t.LINKING="oa:linking",t.MODERATING="oa:moderating",t.PAINTING="sc:painting",t.QUESTIONING="oa:questioning",t.REPLYING="oa:replying",t.TAGGING="oa:tagging",t.TRANSCRIBING="oad:transcribing"}(e.AnnotationMotivation||(e.AnnotationMotivation={})),function(t){t.AUTO_ADVANCE="auto-advance",t.CONTINUOUS="continuous",t.FACING_PAGES="facing-pages",t.HIDDEN="hidden",t.INDIVIDUALS="individuals",t.MULTI_PART="multi-part",t.NO_NAV="no-nav",t.NON_PAGED="non-paged",t.PAGED="paged",t.REPEAT="repeat",t.SEQUENCE="sequence",t.THUMBNAIL_NAV="thumbnail-nav",t.TOGETHER="together",t.UNORDERED="unordered"}(e.Behavior||(e.Behavior={})),function(t){t.CANVAS="canvas",t.CHOICE="choice",t.CONTENT_AS_TEXT="contentastext",t.DOCUMENT="document",t.IMAGE="image",t.MOVING_IMAGE="movingimage",t.PDF="pdf",t.PHYSICAL_OBJECT="physicalobject",t.SOUND="sound",t.TEXTUALBODY="textualbody",t.VIDEO="video"}(e.ExternalResourceType||(e.ExternalResourceType={})),function(t){t.ANNOTATION="annotation",t.CANVAS="canvas",t.COLLECTION="collection",t.MANIFEST="manifest",t.RANGE="range",t.SEQUENCE="sequence"}(e.IIIFResourceType||(e.IIIFResourceType={})),function(t){t.AUDIO_MP4="audio/mp4",t.CORTO="application/corto",t.DRACO="application/draco",t.GLTF="model/gltf+json",t.JPG="image/jpeg",t.M3U8="application/vnd.apple.mpegurl",t.MP3="audio/mp3",t.MPEG_DASH="application/dash+xml",t.OBJ="text/plain",t.PDF="application/pdf",t.PLY="application/ply",t.THREEJS="application/vnd.threejs+json",t.VIDEO_MP4="video/mp4",t.WEBM="video/webm"}(e.MediaType||(e.MediaType={})),function(t){t.DOC="application/msword",t.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",t.PDF="application/pdf"}(e.RenderingFormat||(e.RenderingFormat={})),function(t){t.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",t.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",t.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",t.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",t.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",t.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",t.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",t.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",t.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",t.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",t.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",t.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",t.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",t.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",t.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",t.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",t.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",t.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",t.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",t.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",t.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",t.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",t.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",t.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",t.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",t.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",t.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",t.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",t.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",t.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",t.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",t.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",t.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",t.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",t.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",t.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",t.SEARCH_0="http://iiif.io/api/search/0/search",t.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",t.SEARCH_1="http://iiif.io/api/search/1/search",t.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",t.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",t.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",t.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",t.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",t.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",t.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"}(e.ServiceProfile||(e.ServiceProfile={})),function(t){t.BOTTOM_TO_TOP="bottom-to-top",t.LEFT_TO_RIGHT="left-to-right",t.RIGHT_TO_LEFT="right-to-left",t.TOP_TO_BOTTOM="top-to-bottom"}(e.ViewingDirection||(e.ViewingDirection={})),function(t){t.CONTINUOUS="continuous",t.INDIVIDUALS="individuals",t.NON_PAGED="non-paged",t.PAGED="paged",t.TOP="top"}(e.ViewingHint||(e.ViewingHint={}))},49:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n,r=i(0),o=i(13),a=i(4),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=function(t){function e(e){var i=t.call(this,e)||this;return i._data=i.data(),i._data=i.options.data,i._init(),i._resize(),i}return s(e,t),e.prototype._init=function(){var e=this;t.prototype._init.call(this),this._$element=$(this.el),this._$header=$('<div class="header"></div>'),this._$element.append(this._$header),this._$leftOptions=$('<div class="left"></div>'),this._$header.append(this._$leftOptions),this._$rightOptions=$('<div class="right"></div>'),this._$header.append(this._$rightOptions),this._$sizeDownButton=$('<input class="btn btn-default size-down" type="button" value="-" />'),this._$leftOptions.append(this._$sizeDownButton),this._$sizeRange=$('<input type="range" name="size" min="1" max="10" value="'+this.options.data.initialZoom+'" />'),this._$leftOptions.append(this._$sizeRange),this._$sizeUpButton=$('<input class="btn btn-default size-up" type="button" value="+" />'),this._$leftOptions.append(this._$sizeUpButton),this._$multiSelectOptions=$('<div class="multiSelectOptions"></div>'),this._$rightOptions.append(this._$multiSelectOptions),this._$selectAllButton=$('<div class="multiSelectAll"><input id="multiSelectAll" type="checkbox" tabindex="0" /><label for="multiSelectAll">'+this.options.data.content.selectAll+"</label></div>"),this._$multiSelectOptions.append(this._$selectAllButton),this._$selectAllButtonCheckbox=$(this._$selectAllButton.find("input:checkbox")),this._$selectButton=$('<a class="select" href="#">'+this.options.data.content.select+"</a>"),this._$multiSelectOptions.append(this._$selectButton),this._$main=$('<div class="main"></div>'),this._$element.append(this._$main),this._$thumbs=$('<div class="thumbs"></div>'),this._$main.append(this._$thumbs),this._$sizeDownButton.on("click",(function(){var t=Number(e._$sizeRange.val())-1;t>=Number(e._$sizeRange.attr("min"))&&(e._$sizeRange.val(t.toString()),e._$sizeRange.trigger("change"),e.fire(u.DECREASE_SIZE))})),this._$sizeUpButton.on("click",(function(){var t=Number(e._$sizeRange.val())+1;t<=Number(e._$sizeRange.attr("max"))&&(e._$sizeRange.val(t.toString()),e._$sizeRange.trigger("change"),e.fire(u.INCREASE_SIZE))})),this._$sizeRange.on("change",(function(){e._updateThumbs(),e._scrollToThumb(e._getSelectedThumbIndex())})),this._$selectAllButton.checkboxButton((function(t){var i=e._getMultiSelectState();i&&(t?i.selectAll(!0):i.selectAll(!1)),e.set(e.options.data)})),this._$selectButton.on("click",(function(){var t=e._getMultiSelectState();if(t){var i=t.getAllSelectedCanvases().map((function(t){return t.id}));e.fire(u.MULTISELECTION_MADE,i)}})),this._setRange(),$.templates({galleryThumbsTemplate:'\t\t\t\t<div class="{{:~galleryThumbClassName()}}" data-src="{{>uri}}" data-index="{{>index}}" data-visible="{{>visible}}" data-width="{{>width}}" data-height="{{>height}}" data-initialwidth="{{>initialWidth}}" data-initialheight="{{>initialHeight}}">\t\t\t\t\t\t<div class="wrap" style="width:{{>initialWidth}}px; height:{{>initialHeight}}px" data-link="class{merge:multiSelected toggle=\'multiSelected\'}">\t\t\t\t\t\t{^{if multiSelectEnabled}}\t\t\t\t\t\t\t\t<input id="thumb-checkbox-{{>id}}" type="checkbox" data-link="checked{:multiSelected ? \'checked\' : \'\'}" class="multiSelect" />\t\t\t\t\t\t{{/if}}\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="info">\t\t\t\t\t\t\t\t<span class="index" style="width:{{>initialWidth}}px">{{:#index + 1}}</span>\t\t\t\t\t\t\t\t<span class="label" style="width:{{>initialWidth}}px" title="{{>label}}">{{>label}}&nbsp;</span>\t\t\t\t\t\t\t\t<span class="searchResults" title="{{:~galleryThumbSearchResultsTitle()}}">{{>data.searchResults}}</span>\t\t\t\t\t\t</div>\t\t\t\t</div>'});var i=this;return $.views.helpers({galleryThumbClassName:function(){var t="thumb preLoad";return 0===this.data.index&&(t+=" first"),this.data.uri||(t+=" placeholder"),t},galleryThumbSearchResultsTitle:function(){var t=Number(this.data.data.searchResults);return t?t>1?a.n.format(i.options.data.content.searchResults,t.toString()):a.n.format(i.options.data.content.searchResult,t.toString()):null}}),this._$main.on("scroll",(function(){e._updateThumbs()}),this.options.data.scrollStopDuration),this.options.data.sizingEnabled||this._$sizeRange.hide(),!0},e.prototype.data=function(){return{chunkedResizingThreshold:400,content:{searchResult:"{0} search result",searchResults:"{0} search results",select:"Select",selectAll:"Select All"},debug:!1,helper:null,imageFadeInDuration:300,initialZoom:6,minLabelWidth:20,pageModeEnabled:!1,scrollStopDuration:100,searchResults:[],sizingEnabled:!0,thumbHeight:320,thumbLoadPadding:3,thumbWidth:200,viewingDirection:r.f.LEFT_TO_RIGHT}},e.prototype.set=function(t){if(this._data=Object.assign(this._data,t),this._data.helper&&void 0!==this._data.thumbWidth&&void 0!==this._data.thumbHeight&&(this._thumbs=this._data.helper.getThumbs(this._data.thumbWidth,this._data.thumbHeight)),this._data.viewingDirection&&(this._data.viewingDirection===r.f.BOTTOM_TO_TOP&&this._thumbs.reverse(),this._$thumbs.addClass(this._data.viewingDirection)),this._data.searchResults&&this._data.searchResults.length)for(var e=0;e<this._data.searchResults.length;e++){var i=this._data.searchResults[e],n=this._thumbs.filter((function(t){return t.index===i.canvasIndex}))[0],o=$.extend(!0,{},n.data);o.searchResults=i.rects.length,n.data=o}this._thumbsCache=null,this._createThumbs(),this._data.helper&&this.selectIndex(this._data.helper.canvasIndex);var a=this._getMultiSelectState();if(a&&a.isEnabled){this._$multiSelectOptions.show(),this._$thumbs.addClass("multiSelect");for(e=0;e<a.canvases.length;e++){var s=a.canvases[e];n=this._getThumbByCanvas(s);this._setThumbMultiSelected(n,s.multiSelected)}for(e=0;e<a.ranges.length;e++)for(var l=a.ranges[e],u=this._getThumbsByRange(l),c=0;c<u.length;c++){n=u[c];this._setThumbMultiSelected(n,l.multiSelected)}}else this._$multiSelectOptions.hide(),this._$thumbs.removeClass("multiSelect");this._update()},e.prototype._update=function(){var t=this._getMultiSelectState();t&&t.isEnabled&&(this._$selectAllButtonCheckbox.prop("checked",t.allSelected()),t.getAll().filter((function(t){return t.multiSelected})).length>0?this._$selectButton.show():this._$selectButton.hide())},e.prototype._getMultiSelectState=function(){return this._data.helper?this._data.helper.getMultiSelectState():null},e.prototype._createThumbs=function(){var t=this;if(this._thumbs){this._$thumbs.undelegate(".thumb","click"),this._$thumbs.empty();for(var e=this._getMultiSelectState(),i=[],n=0;n<this._thumbs.length;n++){var r=(c=this._thumbs[n]).width,o=c.height;c.initialWidth=r,i.push(o),c.multiSelectEnabled=!!e&&e.isEnabled}for(var s=a.h.median(i),l=0;l<this._thumbs.length;l++){var c;(c=this._thumbs[l]).initialHeight=s}if(this._$thumbs.link($.templates.galleryThumbsTemplate,this._thumbs),e&&!e.isEnabled)this._$thumbs.delegate(".thumb","click",(function(e){e.preventDefault();var i=$.view(this).data;t.fire(u.THUMB_SELECTED,i)}));else for(var h=this._$thumbs.find(".thumb"),p=function(){var t=f;$(h[d]).checkboxButton((function(e){var i=$.view(this).data;t._setThumbMultiSelected(i,!i.multiSelected);var n=t.options.data.helper.getCanvasRange(i.data),r=t._getMultiSelectState();r&&(n?r.selectRange(n,i.multiSelected):r.selectCanvas(i.data,i.multiSelected)),t._update(),t.fire(u.THUMB_MULTISELECTED,i)}))},f=this,d=0;d<h.length;d++)p()}},e.prototype._getThumbByCanvas=function(t){return this._thumbs.filter((function(e){return e.data.id===t.id}))[0]},e.prototype._sizeThumb=function(t){var e=t.data().initialwidth,i=t.data().initialheight,n=Number(e),r=Number(i),o=Math.floor(n*this._range),a=Math.floor(r*this._range),s=t.find(".wrap"),l=t.find(".label"),u=t.find(".index"),c=t.find(".searchResults"),h=o;this._data.searchResults&&this._data.searchResults.length&&(c.show(),h=o-c.outerWidth(),void 0!==this._data.minLabelWidth&&h<this._data.minLabelWidth?(c.hide(),h=o):c.show()),this._data.pageModeEnabled?(u.hide(),l.show()):(u.show(),l.hide()),s.outerWidth(o),s.outerHeight(a),u.outerWidth(h),l.outerWidth(h)},e.prototype._loadThumb=function(t,e){var i=t.find(".wrap");if(!i.hasClass("loading")&&!i.hasClass("loaded")){t.removeClass("preLoad");var n=t.attr("data-visible"),r=this._data.imageFadeInDuration||0;if("false"!==n){i.addClass("loading");var o=t.attr("data-src"),a=$('<img class="thumbImage" src="'+o+'" />');a.hide(),a.on("load",(function(){$(this).fadeIn(r,(function(){$(this).parent().switchClass("loading","loaded")}))})),i.prepend(a),e&&e(a)}else i.addClass("hidden")}},e.prototype._getThumbsByRange=function(t){var e=[];if(!this._data.helper)return e;for(var i=0;i<this._thumbs.length;i++){var n=this._thumbs[i],r=n.data,o=this._data.helper.getCanvasRange(r,t.path);o&&o.id===t.id&&e.push(n)}return e},e.prototype._updateThumbs=function(){var t=!!this._data.debug;this._setRange();var e=this._$main.scrollTop(),i=e+this._$main.height();t&&console.log("scrollTop %s, scrollBottom %s",e,i);for(var n=this._getAllThumbs(),r=0,o=0;o<n.length;o++){var a=$(n[o]),s=a.position().top,l=a.outerHeight(),u=s+l,c=l*this._data.thumbLoadPadding;s<=i+c&&u>=e-c?(r+=1,this._sizeThumb(a),a.addClass("insideScrollArea"),this._loadThumb(a)):a.removeClass("insideScrollArea")}t&&console.log("number of thumbs to update: "+r)},e.prototype._getSelectedThumbIndex=function(){return Number(this._$selectedThumb.data("index"))},e.prototype._getAllThumbs=function(){return this._thumbsCache||(this._thumbsCache=this._$thumbs.find(".thumb")),this._thumbsCache},e.prototype._getThumbByIndex=function(t){return this._$thumbs.find('[data-index="'+t+'"]')},e.prototype._scrollToThumb=function(t){var e=this._getThumbByIndex(t);this._$main.scrollTop(e.position().top)},e.prototype.selectIndex=function(t){this._thumbs&&this._thumbs.length&&(this._getAllThumbs().removeClass("selected"),this._$selectedThumb=this._getThumbByIndex(t),this._$selectedThumb.addClass("selected"),this._scrollToThumb(t),this._updateThumbs())},e.prototype._setRange=function(){var t=a.h.normalise(Number(this._$sizeRange.val()),0,10);this._range=a.h.clamp(t,.05,1)},e.prototype._setThumbMultiSelected=function(t,e){$.observable(t).setProperty("multiSelected",e)},e.prototype._resize=function(){},e}(o.a),u=function(){function t(){}return t.DECREASE_SIZE="decreaseSize",t.INCREASE_SIZE="increaseSize",t.MULTISELECTION_MADE="multiSelectionMade",t.THUMB_SELECTED="thumbSelected",t.THUMB_MULTISELECTED="thumbMultiSelected",t}()},55:function(t,e,i){var n,r,o,a;"undefined"!=typeof self&&self,t.exports=(n=i(52),r=i(83),o=i(21),a=i(48),function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){var n,r,o,a;"undefined"!=typeof self&&self,t.exports=(n=i(4),r=i(5),o=i(6),a=i(7),function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=3)}([function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(5)),n(i(6)),n(i(7)),n(i(8)),n(i(9)),n(i(10)),n(i(11)),n(i(12)),n(i(13)),n(i(14)),n(i(15)),n(i(16)),n(i(17)),n(i(18)),n(i(19)),n(i(20)),n(i(21)),n(i(22)),n(i(23)),n(i(24)),n(i(25)),n(i(26)),n(i(27)),n(i(28)),n(i(29)),n(i(30)),n(i(31)),n(i(2))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.BOOKMARKING="oa:bookmarking",t.CLASSIFYING="oa:classifying",t.COMMENTING="oa:commenting",t.DESCRIBING="oa:describing",t.EDITING="oa:editing",t.HIGHLIGHTING="oa:highlighting",t.IDENTIFYING="oa:identifying",t.LINKING="oa:linking",t.MODERATING="oa:moderating",t.PAINTING="sc:painting",t.QUESTIONING="oa:questioning",t.REPLYING="oa:replying",t.TAGGING="oa:tagging",t.TRANSCRIBING="oad:transcribing"}(e.AnnotationMotivation||(e.AnnotationMotivation={})),function(t){t.AUTO_ADVANCE="auto-advance",t.CONTINUOUS="continuous",t.FACING_PAGES="facing-pages",t.HIDDEN="hidden",t.INDIVIDUALS="individuals",t.MULTI_PART="multi-part",t.NO_NAV="no-nav",t.NON_PAGED="non-paged",t.PAGED="paged",t.REPEAT="repeat",t.SEQUENCE="sequence",t.THUMBNAIL_NAV="thumbnail-nav",t.TOGETHER="together",t.UNORDERED="unordered"}(e.Behavior||(e.Behavior={})),function(t){t.CANVAS="canvas",t.CHOICE="choice",t.CONTENT_AS_TEXT="contentastext",t.DOCUMENT="document",t.IMAGE="image",t.MOVING_IMAGE="movingimage",t.PDF="pdf",t.PHYSICAL_OBJECT="physicalobject",t.SOUND="sound",t.TEXTUALBODY="textualbody",t.VIDEO="video"}(e.ExternalResourceType||(e.ExternalResourceType={})),function(t){t.ANNOTATION="annotation",t.CANVAS="canvas",t.COLLECTION="collection",t.MANIFEST="manifest",t.RANGE="range",t.SEQUENCE="sequence"}(e.IIIFResourceType||(e.IIIFResourceType={})),function(t){t.AUDIO_MP4="audio/mp4",t.CORTO="application/corto",t.DRACO="application/draco",t.GLTF="model/gltf+json",t.JPG="image/jpeg",t.M3U8="application/vnd.apple.mpegurl",t.MP3="audio/mp3",t.MPEG_DASH="application/dash+xml",t.OBJ="text/plain",t.PDF="application/pdf",t.PLY="application/ply",t.THREEJS="application/vnd.threejs+json",t.VIDEO_MP4="video/mp4",t.WEBM="video/webm"}(e.MediaType||(e.MediaType={})),function(t){t.DOC="application/msword",t.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",t.PDF="application/pdf"}(e.RenderingFormat||(e.RenderingFormat={})),function(t){t.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",t.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",t.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",t.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",t.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",t.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",t.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",t.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",t.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",t.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",t.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",t.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",t.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",t.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",t.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",t.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",t.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",t.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",t.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",t.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",t.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",t.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",t.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",t.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",t.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",t.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",t.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",t.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",t.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",t.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",t.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",t.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",t.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",t.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",t.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",t.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",t.SEARCH_0="http://iiif.io/api/search/0/search",t.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",t.SEARCH_1="http://iiif.io/api/search/1/search",t.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",t.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",t.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",t.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",t.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",t.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",t.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"}(e.ServiceProfile||(e.ServiceProfile={})),function(t){t.BOTTOM_TO_TOP="bottom-to-top",t.LEFT_TO_RIGHT="left-to-right",t.RIGHT_TO_LEFT="right-to-left",t.TOP_TO_BOTTOM="top-to-bottom"}(e.ViewingDirection||(e.ViewingDirection={})),function(t){t.CONTINUOUS="continuous",t.INDIVIDUALS="individuals",t.NON_PAGED="non-paged",t.PAGED="paged",t.TOP="top"}(e.ViewingHint||(e.ViewingHint={}))},function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var i,n,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(1),s=i(32),l=i(37),u=function(){function t(){}return t.getMediaType=function(t){return(t=(t=t.toLowerCase()).split(";")[0]).trim()},t.getImageQuality=function(t){return t===a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1||t===a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2||t===a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1||t===a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2||t===a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1||t===a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2||t===a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1||t===a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2||t===a.ServiceProfile.IMAGE_1_LEVEL_1||t===a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1||t===a.ServiceProfile.IMAGE_1_LEVEL_2||t===a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2?"native":"default"},t.getInexactLocale=function(t){return-1!==t.indexOf("-")?t.substr(0,t.indexOf("-")):t},t.getLocalisedValue=function(t,e){if(!Array.isArray(t))return t;for(var i=0;i<t.length;i++){var n=t[i];if(e===n["@language"])return n["@value"]}var r=e.substr(0,e.indexOf("-"));for(i=0;i<t.length;i++){var o=t[i];if(o["@language"]===r)return o["@value"]}return null},t.generateTreeNodeIds=function(e,i){var n;void 0===i&&(i=0),n=e.parentNode?e.parentNode.id+"-"+i:"0",e.id=n;for(var r=0;r<e.nodes.length;r++){var o=e.nodes[r];t.generateTreeNodeIds(o,r)}},t.normaliseType=function(t){return-1!==(t=t.toLowerCase()).indexOf(":")?t.split(":")[1]:t},t.normaliseUrl=function(t){return-1!==(t=t.substr(t.indexOf("://"))).indexOf("#")&&(t=t.split("#")[0]),t},t.normalisedUrlsMatch=function(e,i){return t.normaliseUrl(e)===t.normaliseUrl(i)},t.isImageProfile=function(e){return!!(t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},t.isLevel0ImageProfile=function(e){return!!(t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0))},t.isLevel1ImageProfile=function(e){return!!(t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1))},t.isLevel2ImageProfile=function(e){return!!(t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},t.parseManifest=function(t,e){return o.Deserialiser.parse(t,e)},t.loadManifest=function(t){return s.request(t,{credentials:"same-origin"})},t.loadExternalResourcesAuth1=function(e,i,n,r,o,a,s,l){return new Promise((function(u,c){var h=e.map((function(e){return t.loadExternalResourceAuth1(e,i,n,r,o,a,s,l)}));Promise.all(h).then((function(){u(e)})).catch((function(t){c(t)}))}))},t.loadExternalResourceAuth1=function(e,i,o,a,s,u,c,h){return n(this,void 0,void 0,(function(){var n;return r(this,(function(r){switch(r.label){case 0:return[4,a(e)];case 1:return(n=r.sent())?[4,e.getData(n)]:[3,6];case 2:return r.sent(),e.status!==l.OK?[3,3]:[2,e];case 3:return[4,t.doAuthChain(e,i,o,s,u,c,h)];case 4:r.sent(),r.label=5;case 5:if(e.status===l.OK||e.status===l.MOVED_TEMPORARILY)return[2,e];throw t.createAuthorizationFailedError();case 6:return[4,e.getData()];case 7:return r.sent(),e.status!==l.MOVED_TEMPORARILY&&e.status!==l.UNAUTHORIZED?[3,9]:[4,t.doAuthChain(e,i,o,s,u,c,h)];case 8:r.sent(),r.label=9;case 9:if(e.status===l.OK||e.status===l.MOVED_TEMPORARILY)return[2,e];throw t.createAuthorizationFailedError()}}))}))},t.doAuthChain=function(e,i,o,a,s,u,c){return n(this,void 0,void 0,(function(){var n,h,p,f,d,_,g,E;return r(this,(function(r){switch(r.label){case 0:return e.isAccessControlled()?((n=e.externalService)&&(n.options=e.options),(h=e.kioskService)&&(h.options=e.options),(p=e.clickThroughService)&&(p.options=e.options),(f=e.loginService)&&(f.options=e.options),e.isResponseHandled||e.status!==l.MOVED_TEMPORARILY?[3,2]:[4,u(e)]):[2,e];case 1:return r.sent(),[2,e];case 2:return d=null,_=null,(d=n)?(_=d,[4,t.attemptResourceWithToken(e,o,d)]):[3,4];case 3:return r.sent(),[2,e];case 4:return(d=h)?(_=d,(g=i(d))?[4,a(g)]:[3,7]):[3,7];case 5:return r.sent(),[4,t.attemptResourceWithToken(e,o,d)];case 6:return r.sent(),[2,e];case 7:return(d=p)?(_=d,[4,s(e,d)]):[3,11];case 8:return(E=r.sent())?[4,a(E)]:[3,11];case 9:return r.sent(),[4,t.attemptResourceWithToken(e,o,d)];case 10:return r.sent(),[2,e];case 11:return(d=f)?(_=d,[4,s(e,d)]):[3,15];case 12:return(E=r.sent())?[4,a(E)]:[3,15];case 13:return r.sent(),[4,t.attemptResourceWithToken(e,o,d)];case 14:return r.sent(),[2,e];case 15:return _&&c(e,_),[2]}}))}))},t.attemptResourceWithToken=function(t,e,i){return n(this,void 0,void 0,(function(){var n,o;return r(this,(function(r){switch(r.label){case 0:return(n=i.getService(a.ServiceProfile.AUTH_1_TOKEN))?[4,e(t,n)]:[3,3];case 1:return(o=r.sent())&&o.accessToken?[4,t.getData(o)]:[3,3];case 2:return r.sent(),[2,t];case 3:return[2]}}))}))},t.loadExternalResourcesAuth09=function(e,i,n,r,o,a,s,l,u,c){return new Promise((function(h,p){var f=e.map((function(e){return t.loadExternalResourceAuth09(e,i,n,r,o,a,s,l,u,c)}));Promise.all(f).then((function(){h(e)})).catch((function(t){p(t)}))}))},t.loadExternalResourceAuth09=function(e,i,n,r,o,a,s,u,c,h){return new Promise((function(p,f){h&&h.pessimisticAccessControl?e.getData().then((function(){e.isAccessControlled()?e.clickThroughService?(p(n(e)),p(r(e))):o(e).then((function(){a(e,!0).then((function(i){e.getData(i).then((function(){p(c(e))})).catch((function(e){f(t.createInternalServerError(e))}))})).catch((function(e){f(t.createInternalServerError(e))}))})).catch((function(e){f(t.createInternalServerError(e))})):p(e)})).catch((function(e){f(t.createInternalServerError(e))})):u(e,i).then((function(h){h?e.getData(h).then((function(){e.status===l.OK?p(c(e)):t.authorize(e,i,n,r,o,a,s,u).then((function(){p(c(e))})).catch((function(e){f(t.createAuthorizationFailedError())}))})).catch((function(e){f(t.createAuthorizationFailedError())})):t.authorize(e,i,n,r,o,a,s,u).then((function(){p(c(e))})).catch((function(e){f(t.createAuthorizationFailedError())}))})).catch((function(e){f(t.createAuthorizationFailedError())}))}))},t.createError=function(t,e){var i=new Error;return i.message=e,i.name=String(t),i},t.createAuthorizationFailedError=function(){return t.createError(o.StatusCode.AUTHORIZATION_FAILED,"Authorization failed")},t.createRestrictedError=function(){return t.createError(o.StatusCode.RESTRICTED,"Restricted")},t.createInternalServerError=function(e){return t.createError(o.StatusCode.INTERNAL_SERVER_ERROR,e)},t.authorize=function(e,i,n,r,o,a,s,u){return new Promise((function(c,h){e.getData().then((function(){e.isAccessControlled()?u(e,i).then((function(u){u?e.getData(u).then((function(){e.status===l.OK?c(e):t.showAuthInteraction(e,i,n,r,o,a,s,c,h)})).catch((function(e){h(t.createInternalServerError(e))})):a(e,!1).then((function(u){u?s(e,u,i).then((function(){e.getData(u).then((function(){e.status===l.OK?c(e):t.showAuthInteraction(e,i,n,r,o,a,s,c,h)})).catch((function(e){h(t.createInternalServerError(e))}))})).catch((function(e){h(t.createInternalServerError(e))})):t.showAuthInteraction(e,i,n,r,o,a,s,c,h)}))})).catch((function(e){h(t.createInternalServerError(e))})):c(e)}))}))},t.showAuthInteraction=function(e,i,n,r,o,a,s,u,c){e.status!==l.MOVED_TEMPORARILY||e.isResponseHandled?e.clickThroughService&&!e.isResponseHandled?n(e).then((function(){a(e,!0).then((function(n){s(e,n,i).then((function(){e.getData(n).then((function(){u(e)})).catch((function(e){c(t.createInternalServerError(e))}))})).catch((function(e){c(t.createInternalServerError(e))}))})).catch((function(e){c(t.createInternalServerError(e))}))})):o(e).then((function(){a(e,!0).then((function(n){s(e,n,i).then((function(){e.getData(n).then((function(){u(e)})).catch((function(e){c(t.createInternalServerError(e))}))})).catch((function(e){c(t.createInternalServerError(e))}))})).catch((function(e){c(t.createInternalServerError(e))}))})):u(e)},t.getService=function(t,e){for(var i=this.getServices(t),n=0;n<i.length;n++){var r=i[n];if(r.getProfile()===e)return r}return null},t.getResourceById=function(e,i){return t.traverseAndFind(e.__jsonld,"@id",i)},t.traverseAndFind=function(e,i,n){if(e.hasOwnProperty(i)&&e[i]===n)return e;for(var r=0;r<Object.keys(e).length;r++)if("object"==typeof e[Object.keys(e)[r]]){var o=t.traverseAndFind(e[Object.keys(e)[r]],i,n);if(null!=o)return o}},t.getServices=function(t){var e,i=[];if(!(e=t.__jsonld?t.__jsonld.service:t.service))return i;Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var r=e[n];if("string"==typeof r){var a=this.getResourceById(t.options.resource,r);a&&i.push(new o.Service(a.__jsonld||a,t.options))}else i.push(new o.Service(r,t.options))}return i},t.getTemporalComponent=function(t){var e=/t=([^&]+)/g.exec(t),i=null;return e&&e[1]&&(i=e[1].split(",")),i},t}();e.Utils=u},function(t,e,i){t.exports=i(4)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}(i(0));var n=i(2);e.loadManifest=function(t){return n.Utils.loadManifest(t)},e.parseManifest=function(t,e){return n.Utils.parseManifest(t,e)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.__jsonld=t,this.context=this.getProperty("context"),this.id=this.getProperty("id")}return t.prototype.getProperty=function(t){var e=null;return this.__jsonld&&((e=this.__jsonld[t])||(e=this.__jsonld["@"+t])),e},t}();e.JSONLDResource=n},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(1),s=function(t){function e(e,i){var n=t.call(this,e)||this;return n.options=i,n}return r(e,t),e.prototype.getIIIFResourceType=function(){return o.Utils.normaliseType(this.getProperty("type"))},e.prototype.getLabel=function(){var t=this.getProperty("label");return t?o.LanguageMap.parse(t,this.options.locale):[]},e.prototype.getDefaultLabel=function(){return o.LanguageMap.getValue(this.getLabel())},e.prototype.getMetadata=function(){var t=this.getProperty("metadata"),e=[];if(!t)return e;for(var i=0;i<t.length;i++){var n=t[i],r=new o.LabelValuePair(this.options.locale);r.parse(n),e.push(r)}return e},e.prototype.getRendering=function(t){for(var e=this.getRenderings(),i=0;i<e.length;i++){var n=e[i];if(n.getFormat()===t)return n}return null},e.prototype.getRenderings=function(){var t,e=[];if(!(t=this.__jsonld?this.__jsonld.rendering:this.rendering))return e;Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];e.push(new o.Rendering(n,this.options))}return e},e.prototype.getService=function(t){return o.Utils.getService(this,t)},e.prototype.getServices=function(){return o.Utils.getServices(this)},e.prototype.getThumbnail=function(){var t=this.getProperty("thumbnail");return Array.isArray(t)&&(t=t[0]),t?new o.Thumbnail(t,this.options):null},e.prototype.isAnnotation=function(){return this.getIIIFResourceType()===a.IIIFResourceType.ANNOTATION},e.prototype.isCanvas=function(){return this.getIIIFResourceType()===a.IIIFResourceType.CANVAS},e.prototype.isCollection=function(){return this.getIIIFResourceType()===a.IIIFResourceType.COLLECTION},e.prototype.isManifest=function(){return this.getIIIFResourceType()===a.IIIFResourceType.MANIFEST},e.prototype.isRange=function(){return this.getIIIFResourceType()===a.IIIFResourceType.RANGE},e.prototype.isSequence=function(){return this.getIIIFResourceType()===a.IIIFResourceType.SEQUENCE},e}(o.JSONLDResource);e.ManifestResource=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e.prototype.getFormat=function(){var t=this.getProperty("format");return t?t.toLowerCase():null},e.prototype.getResources=function(){var t=[];if(!this.__jsonld.resources)return t;for(var e=0;e<this.__jsonld.resources.length;e++){var i=this.__jsonld.resources[e],n=new o.Annotation(i,this.options);t.push(n)}return t},e.prototype.getType=function(){var t=this.getProperty("type");return t?o.Utils.normaliseType(t):null},e.prototype.getWidth=function(){return this.getProperty("width")},e.prototype.getHeight=function(){return this.getProperty("height")},e.prototype.getMaxWidth=function(){return this.getProperty("maxWidth")},e.prototype.getMaxHeight=function(){return this.getProperty("maxHeight")?null:this.getMaxWidth()},e}(o.ManifestResource);e.Resource=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(1),s=function(t){function e(e,i){var n=t.call(this,e,i)||this;n.index=-1,n.isLoaded=!1;var r={defaultLabel:"-",locale:"en-GB",resource:n,pessimisticAccessControl:!1};return n.options=Object.assign(r,i),n}return r(e,t),e.prototype.getAttribution=function(){var t=this.getProperty("attribution");return t?o.LanguageMap.parse(t,this.options.locale):[]},e.prototype.getDescription=function(){var t=this.getProperty("description");return t?o.LanguageMap.parse(t,this.options.locale):[]},e.prototype.getIIIFResourceType=function(){return o.Utils.normaliseType(this.getProperty("type"))},e.prototype.getLogo=function(){var t=this.getProperty("logo");return t?"string"==typeof t?t:(Array.isArray(t)&&t.length&&(t=t[0]),t["@id"]||t.id):null},e.prototype.getLicense=function(){return o.Utils.getLocalisedValue(this.getProperty("license"),this.options.locale)},e.prototype.getNavDate=function(){return new Date(this.getProperty("navDate"))},e.prototype.getRelated=function(){return this.getProperty("related")},e.prototype.getSeeAlso=function(){return this.getProperty("seeAlso")},e.prototype.getTrackingLabel=function(){var t=this.getService(a.ServiceProfile.TRACKING_EXTENSIONS);return t?t.getProperty("trackingLabel"):""},e.prototype.getDefaultTree=function(){return this.defaultTree=new o.TreeNode("root"),this.defaultTree.data=this,this.defaultTree},e.prototype.getRequiredStatement=function(){var t=null,e=this.getProperty("requiredStatement");if(e)(t=new o.LabelValuePair(this.options.locale)).parse(e);else{var i=this.getAttribution();i&&((t=new o.LabelValuePair(this.options.locale)).value=i)}return t},e.prototype.isCollection=function(){return this.getIIIFResourceType()===a.IIIFResourceType.COLLECTION},e.prototype.isManifest=function(){return this.getIIIFResourceType()===a.IIIFResourceType.MANIFEST},e.prototype.load=function(){var t=this;return new Promise((function(e){if(t.isLoaded)e(t);else{var i=t.options;i.navDate=t.getNavDate();var n=t.__jsonld.id;n||(n=t.__jsonld["@id"]),o.Utils.loadManifest(n).then((function(n){t.parentLabel=o.LanguageMap.getValue(t.getLabel(),i.locale);var r=o.Deserialiser.parse(n,i);(t=Object.assign(t,r)).index=i.index,e(t)}))}}))},e}(o.ManifestResource);e.IIIFResource=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e.prototype.getBody=function(){var t=[],e=this.getProperty("body");if(e)if(Array.isArray(e))for(var i=0;i<e.length;i++)if((a=e[i]).items)for(var n=0;n<a.items.length;n++){var r=a.items[n];t.push(new o.AnnotationBody(r,this.options))}else t.push(new o.AnnotationBody(a,this.options));else if(e.items)for(i=0;i<e.items.length;i++){var a=e.items[i];t.push(new o.AnnotationBody(a,this.options))}else t.push(new o.AnnotationBody(e,this.options));return t},e.prototype.getMotivation=function(){return this.getProperty("motivation")||null},e.prototype.getOn=function(){return this.getProperty("on")},e.prototype.getTarget=function(){return this.getProperty("target")},e.prototype.getResource=function(){return new o.Resource(this.getProperty("resource"),this.options)},e}(o.ManifestResource);e.Annotation=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e.prototype.getFormat=function(){var t=this.getProperty("format");return t?o.Utils.getMediaType(t):null},e.prototype.getType=function(){return this.getProperty("type")?o.Utils.normaliseType(this.getProperty("type")):null},e.prototype.getWidth=function(){return this.getProperty("width")},e.prototype.getHeight=function(){return this.getProperty("height")},e}(o.ManifestResource);e.AnnotationBody=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i,n){var r=t.call(this,i)||this;return r.label=e,r.options=n,r}return r(e,t),e.prototype.getIIIFResourceType=function(){return o.Utils.normaliseType(this.getProperty("type"))},e.prototype.getLabel=function(){return this.label},e.prototype.getResources=function(){var t=this;return this.getProperty("resources").map((function(e){return new o.Annotation(e,t.options)}))},e.prototype.load=function(){var t=this;return new Promise((function(e,i){if(t.isLoaded)e(t);else{var n=t.__jsonld.id;n||(n=t.__jsonld["@id"]),o.Utils.loadManifest(n).then((function(i){t.__jsonld=i,t.context=t.getProperty("context"),t.id=t.getProperty("id"),t.isLoaded=!0,e(t)})).catch(i)}}))},e}(o.JSONLDResource);e.AnnotationList=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e.prototype.getItems=function(){return this.getProperty("items")},e}(i(0).ManifestResource);e.AnnotationPage=o},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e.prototype.getCanonicalImageUri=function(t){var e,i=null,n="default",r=t;if(this.externalResource&&this.externalResource.data&&this.externalResource.data["@id"])i=this.externalResource.data["@id"],r||(r=this.externalResource.data.width),this.externalResource.data["@context"]&&(this.externalResource.data["@context"].indexOf("/1.0/context.json")>-1||this.externalResource.data["@context"].indexOf("/1.1/context.json")>-1||this.externalResource.data["@context"].indexOf("/1/context.json")>-1)&&(n="native");else{var a=this.getImages();if(a&&a.length){var s=a[0].getResource(),l=s.getServices();if(r||(r=s.getWidth()),l.length){var u=l[0];i=u.id,n=o.Utils.getImageQuality(u.getProfile())}else if(r===s.getWidth())return s.id}if(!i){var c=this.getProperty("thumbnail");if(c){if("string"==typeof c)return c;if(c["@id"])return c["@id"];if(c.length)return c[0].id}}}return e=r+",",i&&i.endsWith("/")&&(i=i.substr(0,i.length-1)),[i,"full",e,0,n+".jpg"].join("/")},e.prototype.getMaxDimensions=function(){var t,e=null;return this.externalResource&&this.externalResource.data&&this.externalResource.data.profile&&(t=this.externalResource.data.profile,Array.isArray(t)&&(t=t.filter((function(t){return t.maxWidth}))[0])&&(e=new o.Size(t.maxWidth,t.maxHeight?t.maxHeight:t.maxWidth))),e},e.prototype.getContent=function(){var t=[],e=this.__jsonld.items||this.__jsonld.content;if(!e)return t;var i=null;if(e.length&&(i=new o.AnnotationPage(e[0],this.options)),!i)return t;for(var n=i.getItems(),r=0;r<n.length;r++){var a=n[r],s=new o.Annotation(a,this.options);t.push(s)}return t},e.prototype.getDuration=function(){return this.getProperty("duration")},e.prototype.getImages=function(){var t=[];if(!this.__jsonld.images)return t;for(var e=0;e<this.__jsonld.images.length;e++){var i=this.__jsonld.images[e],n=new o.Annotation(i,this.options);t.push(n)}return t},e.prototype.getIndex=function(){return this.getProperty("index")},e.prototype.getOtherContent=function(){var t=this,e=(Array.isArray(this.getProperty("otherContent"))?this.getProperty("otherContent"):[this.getProperty("otherContent")]).filter((function(t){return t&&"string"==typeof(e=t["@type"])&&e.toLowerCase()==e.toLowerCase();var e})).map((function(e,i){return new o.AnnotationList(e.label||"Annotation list "+i,e,t.options)})).map((function(t){return t.load()}));return Promise.all(e)},e.prototype.getWidth=function(){return this.getProperty("width")},e.prototype.getHeight=function(){return this.getProperty("height")},e}(o.Resource);e.Canvas=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(1),a=i(0),s=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.items=[],n._collections=null,n._manifests=null,e.__collection=n,n}return r(e,t),e.prototype.getCollections=function(){return this._collections?this._collections:this._collections=this.items.filter((function(t){return t.isCollection()}))},e.prototype.getManifests=function(){return this._manifests?this._manifests:this._manifests=this.items.filter((function(t){return t.isManifest()}))},e.prototype.getCollectionByIndex=function(t){for(var e,i=this.getCollections(),n=0;n<i.length;n++){var r=i[n];r.index===t&&(e=r)}if(e)return e.options.index=t,e.load();throw new Error("Collection index not found")},e.prototype.getManifestByIndex=function(t){for(var e,i=this.getManifests(),n=0;n<i.length;n++){var r=i[n];r.index===t&&(e=r)}if(e)return e.options.index=t,e.load();throw new Error("Manifest index not found")},e.prototype.getTotalCollections=function(){return this.getCollections().length},e.prototype.getTotalManifests=function(){return this.getManifests().length},e.prototype.getTotalItems=function(){return this.items.length},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):o.ViewingDirection.LEFT_TO_RIGHT},e.prototype.getDefaultTree=function(){return t.prototype.getDefaultTree.call(this),this.defaultTree.data.type=a.Utils.normaliseType(a.TreeNodeType.COLLECTION),this._parseManifests(this),this._parseCollections(this),a.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},e.prototype._parseManifests=function(t){if(t.getManifests()&&t.getManifests().length)for(var e=0;e<t.getManifests().length;e++){var i=t.getManifests()[e],n=i.getDefaultTree();n.label=i.parentLabel||a.LanguageMap.getValue(i.getLabel(),this.options.locale)||"manifest "+(e+1),n.navDate=i.getNavDate(),n.data.id=i.id,n.data.type=a.Utils.normaliseType(a.TreeNodeType.MANIFEST),t.defaultTree.addNode(n)}},e.prototype._parseCollections=function(t){if(t.getCollections()&&t.getCollections().length)for(var e=0;e<t.getCollections().length;e++){var i=t.getCollections()[e],n=i.getDefaultTree();n.label=i.parentLabel||a.LanguageMap.getValue(i.getLabel(),this.options.locale)||"collection "+(e+1),n.navDate=i.getNavDate(),n.data.id=i.id,n.data.type=a.Utils.normaliseType(a.TreeNodeType.COLLECTION),t.defaultTree.addNode(n)}},e}(a.IIIFResource);e.Collection=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.start=t,this.end=e}return t.prototype.getLength=function(){return this.end-this.start},t}();e.Duration=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=function(){function t(t){this.defaultLocale=t}return t.prototype.parse=function(t){this.resource=t,this.label=n.LanguageMap.parse(this.resource.label,this.defaultLocale),this.value=n.LanguageMap.parse(this.resource.value,this.defaultLocale)},t.prototype.getLabel=function(){return this.label?n.LanguageMap.getValue(this.label,this.defaultLocale):null},t.prototype.setLabel=function(t){var e=this;if(this.label&&this.label.length){var i=this.label.filter((function(t){return t.locale===e.defaultLocale||t.locale===n.Utils.getInexactLocale(e.defaultLocale)}))[0];i&&(i.value=t)}},t.prototype.getValue=function(){if(this.value){var t=this.defaultLocale;return this.label&&this.label.length&&this.label[0].locale&&(t=this.label[0].locale),n.LanguageMap.getValue(this.value,t)}return null},t.prototype.setValue=function(t){var e=this;if(this.value&&this.value.length){var i=this.value.filter((function(t){return t.locale===e.defaultLocale||t.locale===n.Utils.getInexactLocale(e.defaultLocale)}))[0];i&&(i.value=t)}},t}();e.LabelValuePair=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Language=function(t,e){Array.isArray(t)?1===t.length?this.value=t[0]:this.value=t.join("<br/>"):this.value=t,this.locale=e}},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.parse=function(t,e){var i,n=[];if(!t)return n;if(Array.isArray(t))for(var r=0;r<t.length;r++){var a=t[r];i="string"==typeof a?new o.Language(a,e):new o.Language(a["@value"],a["@language"]||e),n.push(i)}else{if("string"==typeof t)return i=new o.Language(t,e),n.push(i),n;t["@value"]?(i=new o.Language(t["@value"],t["@language"]||e),n.push(i)):Object.keys(t).forEach((function(e){if(!t[e].length)throw new Error("language must have a value");i=new o.Language(t[e],e),n.push(i)}))}return n},e.getValue=function(t,e){if(t.length){if(e){var i=t.filter((function(t){return t.locale===e||o.Utils.getInexactLocale(t.locale)===o.Utils.getInexactLocale(e)}))[0];if(i)return i.value}return t[0].value}return null},e}(Array);e.LanguageMap=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(1),a=i(0),s=function(t){function e(e,i){var n=t.call(this,e,i)||this;if(n.index=0,n._allRanges=null,n.items=[],n._topRanges=[],n.__jsonld.structures&&n.__jsonld.structures.length)for(var r=n._getTopRanges(),o=0;o<r.length;o++){var a=r[o];n._parseRanges(a,String(o))}return n}return r(e,t),e.prototype.getPosterCanvas=function(){var t=this.getProperty("posterCanvas");return t&&(t=new a.Canvas(t,this.options)),t},e.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},e.prototype.getDefaultTree=function(){if(t.prototype.getDefaultTree.call(this),this.defaultTree.data.type=a.Utils.normaliseType(a.TreeNodeType.MANIFEST),!this.isLoaded)return this.defaultTree;var e=this.getTopRanges();return e.length&&e[0].getTree(this.defaultTree),a.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},e.prototype._getTopRanges=function(){var t=[];if(this.__jsonld.structures&&this.__jsonld.structures.length){for(var e=0;e<this.__jsonld.structures.length;e++){var i=this.__jsonld.structures[e];i.viewingHint===o.ViewingHint.TOP&&t.push(i)}if(!t.length){var n={};n.ranges=this.__jsonld.structures,t.push(n)}}return t},e.prototype.getTopRanges=function(){return this._topRanges},e.prototype._getRangeById=function(t){if(this.__jsonld.structures&&this.__jsonld.structures.length)for(var e=0;e<this.__jsonld.structures.length;e++){var i=this.__jsonld.structures[e];if(i["@id"]===t||i.id===t)return i}return null},e.prototype._parseRanges=function(t,e,i){var n,r=null;if("string"==typeof t&&(r=t,t=this._getRangeById(r)),t){(n=new a.Range(t,this.options)).parentRange=i,n.path=e,i?i.items.push(n):this._topRanges.push(n);var o=t.items||t.members;if(o)for(var s=0;s<o.length;s++){var l=o[s];if(l["@type"]&&"sc:range"===l["@type"].toLowerCase()||l.type&&"range"===l.type.toLowerCase())this._parseRanges(l,e+"/"+s,n);else if(l["@type"]&&"sc:canvas"===l["@type"].toLowerCase()||l.type&&"canvas"===l.type.toLowerCase()){n.canvases||(n.canvases=[]);var u=l.id||l["@id"];n.canvases.push(u)}}else if(t.ranges)for(s=0;s<t.ranges.length;s++)this._parseRanges(t.ranges[s],e+"/"+s,n)}else console.warn("Range:",r,"does not exist")},e.prototype.getAllRanges=function(){if(null!=this._allRanges)return this._allRanges;this._allRanges=[];for(var t=this.getTopRanges(),e=function(e){var n=t[e];n.id&&i._allRanges.push(n);var r=function(t,e){t.add(e);var i=e.getRanges();return i.length?i.reduce(r,t):t},o=Array.from(n.getRanges().reduce(r,new Set));i._allRanges=i._allRanges.concat(o)},i=this,n=0;n<t.length;n++)e(n);return this._allRanges},e.prototype.getRangeById=function(t){for(var e=this.getAllRanges(),i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n}return null},e.prototype.getRangeByPath=function(t){for(var e=this.getAllRanges(),i=0;i<e.length;i++){var n=e[i];if(n.path===t)return n}return null},e.prototype.getSequences=function(){if(this.items.length)return this.items;var t=this.__jsonld.mediaSequences||this.__jsonld.sequences;if(t)for(var e=0;e<t.length;e++){var i=t[e],n=new a.Sequence(i,this.options);this.items.push(n)}else this.__jsonld.items&&(n=new a.Sequence(this.__jsonld.items,this.options),this.items.push(n));return this.items},e.prototype.getSequenceByIndex=function(t){return this.getSequences()[t]},e.prototype.getTotalSequences=function(){return this.getSequences().length},e.prototype.getManifestType=function(){var t=this.getService(o.ServiceProfile.UI_EXTENSIONS);return t?t.getProperty("manifestType"):a.ManifestType.EMPTY},e.prototype.isMultiSequence=function(){return this.getTotalSequences()>1},e.prototype.isPagingEnabled=function(){var t=this.getViewingHint();if(t)return t===o.ViewingHint.PAGED;var e=this.getBehavior();return!!e&&e===o.Behavior.PAGED},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e}(a.IIIFResource);e.Manifest=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.EMPTY="",t.MANUSCRIPT="manuscript",t.MONOGRAPH="monograph"}(e.ManifestType||(e.ManifestType={}))},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(1),s=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._ranges=null,n.canvases=null,n.items=[],n}return r(e,t),e.prototype.getCanvasIds=function(){return this.__jsonld.canvases?this.__jsonld.canvases:this.canvases?this.canvases:[]},e.prototype.getDuration=function(){var t,e;if(this.canvases&&this.canvases.length)for(var i=0;i<this.canvases.length;i++){var n=this.canvases[i],r=o.Utils.getTemporalComponent(n);r&&r.length>1&&(0===i&&(t=Number(r[0])),i===this.canvases.length-1&&(e=Number(r[1])))}else{var a=this.getRanges();for(i=0;i<a.length;i++){var s=a[i].getDuration();s&&(0===i&&(t=s.start),i===a.length-1&&(e=s.end))}}if(void 0!==t&&void 0!==e)return new o.Duration(t,e)},e.prototype.getRanges=function(){return this._ranges?this._ranges:this._ranges=this.items.filter((function(t){return t.isRange()}))},e.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e.prototype.getTree=function(t){t.data=this,this.treeNode=t;var e=this.getRanges();if(e&&e.length)for(var i=0;i<e.length;i++){var n=e[i],r=new o.TreeNode;t.addNode(r),this._parseTreeNode(r,n)}return o.Utils.generateTreeNodeIds(t),t},e.prototype.spansTime=function(t){var e=this.getDuration();return!!(e&&t>=e.start&&t<=e.end)},e.prototype._parseTreeNode=function(t,e){t.label=o.LanguageMap.getValue(e.getLabel(),this.options.locale),t.data=e,t.data.type=o.Utils.normaliseType(o.TreeNodeType.RANGE),e.treeNode=t;var i=e.getRanges();if(i&&i.length)for(var n=0;n<i.length;n++){var r=i[n];if(r.getBehavior()!==a.Behavior.NO_NAV){var s=new o.TreeNode;t.addNode(s),this._parseTreeNode(s,r)}}},e}(o.ManifestResource);e.Range=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e.prototype.getFormat=function(){return this.getProperty("format")},e}(i(0).ManifestResource);e.Rendering=o},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(1),a=i(0),s=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.items=[],n._thumbnails=null,n}return r(e,t),e.prototype.getCanvases=function(){if(this.items.length)return this.items;var t=this.__jsonld.canvases||this.__jsonld.elements;if(t)for(var e=0;e<t.length;e++){var i=t[e];(n=new a.Canvas(i,this.options)).index=e,this.items.push(n)}else if(this.__jsonld)for(e=0;e<this.__jsonld.length;e++){var n;i=this.__jsonld[e],(n=new a.Canvas(i,this.options)).index=e,this.items.push(n)}return this.items},e.prototype.getCanvasById=function(t){for(var e=0;e<this.getTotalCanvases();e++){var i=this.getCanvasByIndex(e),n=a.Utils.normaliseUrl(i.id);if(a.Utils.normaliseUrl(t)===n)return i}return null},e.prototype.getCanvasByIndex=function(t){return this.getCanvases()[t]},e.prototype.getCanvasIndexById=function(t){for(var e=0;e<this.getTotalCanvases();e++)if(this.getCanvasByIndex(e).id===t)return e;return null},e.prototype.getCanvasIndexByLabel=function(t,e){t=t.trim(),isNaN(t)||(t=parseInt(t,10).toString(),e&&(t+="r"));for(var i,n,r,o=/(\d*)\D+(\d*)/,s=0;s<this.getTotalCanvases();s++){var l=this.getCanvasByIndex(s);if(a.LanguageMap.getValue(l.getLabel(),this.options.locale)===t)return s;if((i=o.exec(t))&&(n=i[1],(r=i[2])&&new RegExp("^"+n+"\\D+"+r+"$").test(l.getLabel().toString())))return s}return-1},e.prototype.getLastCanvasLabel=function(t){for(var e=this.getTotalCanvases()-1;e>=0;e--){var i=this.getCanvasByIndex(e),n=a.LanguageMap.getValue(i.getLabel(),this.options.locale);if(t){if(/^[a-zA-Z0-9]*$/.test(n))return n}else if(n)return n}return this.options.defaultLabel},e.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},e.prototype.getNextPageIndex=function(t,e){var i;if(e){var n=this.getPagedIndices(t),r=this.getViewingDirection();i=r&&r===o.ViewingDirection.RIGHT_TO_LEFT?n[0]+1:n[n.length-1]+1}else i=t+1;return i>this.getLastPageIndex()?-1:i},e.prototype.getPagedIndices=function(t,e){var i=[];if(e){i=this.isFirstCanvas(t)||this.isLastCanvas(t)?[t]:t%2?[t,t+1]:[t-1,t];var n=this.getViewingDirection();n&&n===o.ViewingDirection.RIGHT_TO_LEFT&&(i=i.reverse())}else i.push(t);return i},e.prototype.getPrevPageIndex=function(t,e){var i;if(e){var n=this.getPagedIndices(t),r=this.getViewingDirection();i=r&&r===o.ViewingDirection.RIGHT_TO_LEFT?n[n.length-1]-1:n[0]-1}else i=t-1;return i},e.prototype.getStartCanvasIndex=function(){var t=this.getStartCanvas();if(t)for(var e=0;e<this.getTotalCanvases();e++)if(this.getCanvasByIndex(e).id===t)return e;return 0},e.prototype.getThumbs=function(t,e){for(var i=[],n=this.getTotalCanvases(),r=0;r<n;r++){var o=this.getCanvasByIndex(r),s=new a.Thumb(t,o);i.push(s)}return i},e.prototype.getThumbnails=function(){if(null!=this._thumbnails)return this._thumbnails;this._thumbnails=[];for(var t=this.getCanvases(),e=0;e<t.length;e++){var i=t[e].getThumbnail();i&&this._thumbnails.push(i)}return this._thumbnails},e.prototype.getStartCanvas=function(){return this.getProperty("startCanvas")},e.prototype.getTotalCanvases=function(){return this.getCanvases().length},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):this.options.resource.getViewingDirection?this.options.resource.getViewingDirection():null},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e.prototype.isCanvasIndexOutOfRange=function(t){return t>this.getTotalCanvases()-1},e.prototype.isFirstCanvas=function(t){return 0===t},e.prototype.isLastCanvas=function(t){return t===this.getTotalCanvases()-1},e.prototype.isMultiCanvas=function(){return this.getTotalCanvases()>1},e.prototype.isPagingEnabled=function(){var t=this.getViewingHint();return!!t&&t===o.ViewingHint.PAGED},e.prototype.isTotalCanvasesEven=function(){return this.getTotalCanvases()%2==0},e}(a.ManifestResource);e.Sequence=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=function(){function t(){}return t.parse=function(t,e){return"string"==typeof t&&(t=JSON.parse(t)),this.parseJson(t,e)},t.parseJson=function(t,e){var i;if(e&&e.navDate&&!isNaN(e.navDate.getTime())&&(t.navDate=e.navDate.toString()),t["@type"])switch(t["@type"]){case"sc:Collection":i=this.parseCollection(t,e);break;case"sc:Manifest":i=this.parseManifest(t,e);break;default:return null}else switch(t.type){case"Collection":i=this.parseCollection(t,e);break;case"Manifest":i=this.parseManifest(t,e);break;default:return null}return i.isLoaded=!0,i},t.parseCollection=function(t,e){var i=new n.Collection(t,e);return e?(i.index=e.index||0,e.resource&&(i.parentCollection=e.resource.parentCollection)):i.index=0,this.parseCollections(i,e),this.parseManifests(i,e),this.parseItems(i,e),i},t.parseCollections=function(t,e){var i;if(t.__jsonld.collections?i=t.__jsonld.collections:t.__jsonld.items&&(i=t.__jsonld.items.filter((function(t){return"collection"===t.type.toLowerCase()}))),i)for(var n=0;n<i.length;n++){e&&(e.index=n);var r=this.parseCollection(i[n],e);r.index=n,r.parentCollection=t,t.items.push(r)}},t.parseManifest=function(t,e){return new n.Manifest(t,e)},t.parseManifests=function(t,e){var i;if(t.__jsonld.manifests?i=t.__jsonld.manifests:t.__jsonld.items&&(i=t.__jsonld.items.filter((function(t){return"manifest"===t.type.toLowerCase()}))),i)for(var n=0;n<i.length;n++){var r=this.parseManifest(i[n],e);r.index=n,r.parentCollection=t,t.items.push(r)}},t.parseItem=function(t,e){if(t["@type"]){if("sc:manifest"===t["@type"].toLowerCase())return this.parseManifest(t,e);if("sc:collection"===t["@type"].toLowerCase())return this.parseCollection(t,e)}else if(t.type){if("manifest"===t.type.toLowerCase())return this.parseManifest(t,e);if("collection"===t.type.toLowerCase())return this.parseCollection(t,e)}return null},t.parseItems=function(t,e){var i=t.__jsonld.members||t.__jsonld.items;if(i)for(var n=function(n){e&&(e.index=n);var o=r.parseItem(i[n],e);return o?t.items.filter((function(t){return t.id===o.id}))[0]?"continue":(o.index=n,o.parentCollection=t,void t.items.push(o)):{value:void 0}},r=this,o=0;o<i.length;o++){var a=n(o);if("object"==typeof a)return a.value}},t}();e.Deserialiser=r},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e.prototype.getProfile=function(){var t=this.getProperty("profile");return t||(t=this.getProperty("dcterms:conformsTo")),Array.isArray(t)?t[0]:t},e.prototype.getConfirmLabel=function(){return o.Utils.getLocalisedValue(this.getProperty("confirmLabel"),this.options.locale)},e.prototype.getDescription=function(){return o.Utils.getLocalisedValue(this.getProperty("description"),this.options.locale)},e.prototype.getFailureDescription=function(){return o.Utils.getLocalisedValue(this.getProperty("failureDescription"),this.options.locale)},e.prototype.getFailureHeader=function(){return o.Utils.getLocalisedValue(this.getProperty("failureHeader"),this.options.locale)},e.prototype.getHeader=function(){return o.Utils.getLocalisedValue(this.getProperty("header"),this.options.locale)},e.prototype.getServiceLabel=function(){return o.Utils.getLocalisedValue(this.getProperty("label"),this.options.locale)},e.prototype.getInfoUri=function(){var t=this.id;return t.endsWith("/")||(t+="/"),t+"info.json"},e}(o.ManifestResource);e.Service=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Size=function(t,e){this.width=t,this.height=e}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.AUTHORIZATION_FAILED=1]="AUTHORIZATION_FAILED",t[t.FORBIDDEN=2]="FORBIDDEN",t[t.INTERNAL_SERVER_ERROR=3]="INTERNAL_SERVER_ERROR",t[t.RESTRICTED=4]="RESTRICTED"}(e.StatusCode||(e.StatusCode={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0);e.Thumb=function(t,e){this.data=e,this.index=e.index,this.width=t;var i=e.getHeight()/e.getWidth();this.height=i?Math.floor(this.width*i):t,this.uri=e.getCanonicalImageUri(t),this.label=n.LanguageMap.getValue(e.getLabel())}},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e}(i(0).Resource);e.Thumbnail=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=function(){function t(t,e){this.label=t,this.data=e||{},this.nodes=[]}return t.prototype.addNode=function(t){this.nodes.push(t),t.parentNode=this},t.prototype.isCollection=function(){return this.data.type===n.Utils.normaliseType(n.TreeNodeType.COLLECTION)},t.prototype.isManifest=function(){return this.data.type===n.Utils.normaliseType(n.TreeNodeType.MANIFEST)},t.prototype.isRange=function(){return this.data.type===n.Utils.normaliseType(n.TreeNodeType.RANGE)},t}();e.TreeNode=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.COLLECTION="collection",t.MANIFEST="manifest",t.RANGE="range"}(e.TreeNodeType||(e.TreeNodeType={}))},function(t,e,i){!function(t,e,i,n,r){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,i=i&&i.hasOwnProperty("default")?i.default:i,n=n&&n.hasOwnProperty("default")?n.default:n,r=r&&r.hasOwnProperty("default")?r.default:r;class o extends Error{constructor({networkError:t,status:e,statusText:i,body:n,url:r,init:a},...s){super(...s),Error.captureStackTrace&&Error.captureStackTrace(this,o),this.name="FetchError",this.status=e,this.statusText=i,this.body=n,this.url=r,this.init=a,this.networkError=t,this.url&&(this.message=`error while fetching ${this.url}\n\nstatus: ${this.status}\n\ninit: ${JSON.stringify(a,void 0,2)}\n\nbody: ${JSON.stringify(n,void 0,2)}\n`)}}const a="undefined"!=typeof fetch,s=a?fetch:e(n),l=a?Headers:n.Headers,u=a?Request:n.Request,c=a?Response:n.Response,h=a?FormData:i,p=a?URL:r.URL,f=a?URLSearchParams:r.URLSearchParams,d=new RegExp("^application/(.*\\+)?json"),_=new RegExp("^application/(.*\\+)?xml");t.FetchError=o,t.FormData=h,t.Headers=l,t.Request=u,t.Response=c,t.URL=p,t.URLSearchParams=f,t.fetch=s,t.request=async function(t,e){let i;try{i=await s(t,e)}catch(t){throw new o({networkError:{message:t.message}})}const n=await async function(t){const{headers:e}=t,i=e.get("Content-Type");let n="blob";i?i.startsWith("text/")||_.test(i)?n="text":d.test(i)&&(n="json"):n="blob";const r=t[n](),o=await r;return{status:t.status,statusText:t.statusText,ok:t.ok,body:o}}(i);if(!n.ok)throw new o({status:n.status,statusText:n.statusText,body:n.body,url:t});return n.body},Object.defineProperty(t,"__esModule",{value:!0})}(e,i(33),i(34),i(35),i(36))},function(t,e){t.exports=n},function(t,e){t.exports=r},function(t,e){t.exports=o},function(t,e){t.exports=a},function(t,e,i){window,t.exports=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CONTINUE=100,e.SWITCHING_PROTOCOLS=101,e.PROCESSING=102,e.OK=200,e.CREATED=201,e.ACCEPTED=202,e.NON_AUTHORITATIVE_INFORMATION=203,e.NO_CONTENT=204,e.RESET_CONTENT=205,e.PARTIAL_CONTENT=206,e.MULTI_STATUS=207,e.MULTIPLE_CHOICES=300,e.MOVED_PERMANENTLY=301,e.MOVED_TEMPORARILY=302,e.SEE_OTHER=303,e.NOT_MODIFIED=304,e.USE_PROXY=305,e.TEMPORARY_REDIRECT=307,e.BAD_REQUEST=400,e.UNAUTHORIZED=401,e.PAYMENT_REQUIRED=402,e.FORBIDDEN=403,e.NOT_FOUND=404,e.METHOD_NOT_ALLOWED=405,e.NOT_ACCEPTABLE=406,e.PROXY_AUTHENTICATION_REQUIRED=407,e.REQUEST_TIME_OUT=408,e.CONFLICT=409,e.GONE=410,e.LENGTH_REQUIRED=411,e.PRECONDITION_FAILED=412,e.REQUEST_ENTITY_TOO_LARGE=413,e.REQUEST_URI_TOO_LARGE=414,e.UNSUPPORTED_MEDIA_TYPE=415,e.REQUESTED_RANGE_NOT_SATISFIABLE=416,e.EXPECTATION_FAILED=417,e.IM_A_TEAPOT=418,e.UNPROCESSABLE_ENTITY=422,e.LOCKED=423,e.FAILED_DEPENDENCY=424,e.UNORDERED_COLLECTION=425,e.UPGRADE_REQUIRED=426,e.PRECONDITION_REQUIRED=428,e.TOO_MANY_REQUESTS=429,e.REQUEST_HEADER_FIELDS_TOO_LARGE=431,e.INTERNAL_SERVER_ERROR=500,e.NOT_IMPLEMENTED=501,e.BAD_GATEWAY=502,e.SERVICE_UNAVAILABLE=503,e.GATEWAY_TIME_OUT=504,e.HTTP_VERSION_NOT_SUPPORTED=505,e.VARIANT_ALSO_NEGOTIATES=506,e.INSUFFICIENT_STORAGE=507,e.BANDWIDTH_LIMIT_EXCEEDED=509,e.NOT_EXTENDED=510,e.NETWORK_AUTHENTICATION_REQUIRED=511}])}]))},function(t,e,i){window,t.exports=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CONTINUE=100,e.SWITCHING_PROTOCOLS=101,e.PROCESSING=102,e.OK=200,e.CREATED=201,e.ACCEPTED=202,e.NON_AUTHORITATIVE_INFORMATION=203,e.NO_CONTENT=204,e.RESET_CONTENT=205,e.PARTIAL_CONTENT=206,e.MULTI_STATUS=207,e.MULTIPLE_CHOICES=300,e.MOVED_PERMANENTLY=301,e.MOVED_TEMPORARILY=302,e.SEE_OTHER=303,e.NOT_MODIFIED=304,e.USE_PROXY=305,e.TEMPORARY_REDIRECT=307,e.BAD_REQUEST=400,e.UNAUTHORIZED=401,e.PAYMENT_REQUIRED=402,e.FORBIDDEN=403,e.NOT_FOUND=404,e.METHOD_NOT_ALLOWED=405,e.NOT_ACCEPTABLE=406,e.PROXY_AUTHENTICATION_REQUIRED=407,e.REQUEST_TIME_OUT=408,e.CONFLICT=409,e.GONE=410,e.LENGTH_REQUIRED=411,e.PRECONDITION_FAILED=412,e.REQUEST_ENTITY_TOO_LARGE=413,e.REQUEST_URI_TOO_LARGE=414,e.UNSUPPORTED_MEDIA_TYPE=415,e.REQUESTED_RANGE_NOT_SATISFIABLE=416,e.EXPECTATION_FAILED=417,e.IM_A_TEAPOT=418,e.UNPROCESSABLE_ENTITY=422,e.LOCKED=423,e.FAILED_DEPENDENCY=424,e.UNORDERED_COLLECTION=425,e.UPGRADE_REQUIRED=426,e.PRECONDITION_REQUIRED=428,e.TOO_MANY_REQUESTS=429,e.REQUEST_HEADER_FIELDS_TOO_LARGE=431,e.INTERNAL_SERVER_ERROR=500,e.NOT_IMPLEMENTED=501,e.BAD_GATEWAY=502,e.SERVICE_UNAVAILABLE=503,e.GATEWAY_TIME_OUT=504,e.HTTP_VERSION_NOT_SUPPORTED=505,e.VARIANT_ALSO_NEGOTIATES=506,e.INSUFFICIENT_STORAGE=507,e.BANDWIDTH_LIMIT_EXCEEDED=509,e.NOT_EXTENDED=510,e.NETWORK_AUTHENTICATION_REQUIRED=511}])},function(t,e,i){t.exports=i(3)},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(9),s=function(t){function e(e){var i=t.call(this,e)||this;return i._data=i.data(),i._data=i.options.data,i._init(),i._resize(),i}return r(e,t),e.prototype._init=function(){t.prototype._init.call(this),this._$element=$(this.el);var e=this;return this._$tree=$('<ul class="tree"></ul>'),this._$element.append(this._$tree),$.templates({pageTemplate:"{^{for nodes}}\t\t\t\t\t{^{tree/}}\t\t\t\t{{/for}}",treeTemplate:'<li>\t\t\t\t\t\t{^{if nodes && nodes.length}}\t\t\t\t\t\t\t<div class="toggle" data-link="class{merge:expanded toggle=\'expanded\'}"></div>\t\t\t\t\t\t{{else}}\t\t\t\t\t\t<div class="spacer"></div>\t\t\t\t\t\t{{/if}}\t\t\t\t\t\t{^{if multiSelectEnabled}}\t\t\t\t\t\t\t<input id="tree-checkbox-{{>id}}" type="checkbox" data-link="checked{:multiSelected ? \'checked\' : \'\'}" class="multiSelect" />\t\t\t\t\t\t{{/if}}\t\t\t\t\t\t{^{if selected}}\t\t\t\t\t\t\t<a id="tree-link-{{>id}}" href="#" title="{{>label}}" class="selected">{{>label}}</a>\t\t\t\t\t\t{{else}}\t\t\t\t\t\t\t<a id="tree-link-{{>id}}" href="#" title="{{>label}}">{{>label}}</a>\t\t\t\t\t\t{{/if}}\t\t\t\t</li>\t\t\t\t{^{if expanded}}\t\t\t\t\t<li>\t\t\t\t\t\t\t<ul>\t\t\t\t\t\t\t\t\t{^{for nodes}}\t\t\t\t\t\t\t\t\t\t{^{tree/}}\t\t\t\t\t\t\t\t\t{{/for}}\t\t\t\t\t\t\t</ul>\t\t\t\t\t</li>\t\t\t\t{{/if}}'}),$.views.tags({tree:{toggleExpanded:function(){var t=this.data;e._setNodeExpanded(t,!t.expanded)},toggleMultiSelect:function(){var t=this.data;if(e._setNodeMultiSelected(t,!t.multiSelected),t.isRange()){var i=e._getMultiSelectState();i&&i.selectRange(t.data,t.multiSelected)}e.fire(l.TREE_NODE_MULTISELECTED,t)},init:function(t,e,i){this.data=t.view.data},onAfterLink:function(){var t=this;t.contents("li").first().on("click",".toggle",(function(){t.toggleExpanded()})).on("click","a",(function(i){i.preventDefault();var n=t.data;n.nodes.length&&e._data.branchNodesExpandOnClick&&t.toggleExpanded(),n.multiSelectEnabled?t.toggleMultiSelect():n.nodes.length?e._data.branchNodesSelectable&&(e.fire(l.TREE_NODE_SELECTED,n),e.selectNode(n)):(e.fire(l.TREE_NODE_SELECTED,n),e.selectNode(n))})).on("click","input.multiSelect",(function(e){t.toggleMultiSelect()}))},template:$.templates.treeTemplate}}),!0},e.prototype.set=function(t){var e=this;if(this._data=Object.assign(this._data,t),this._data.helper){this._rootNode=this._data.helper.getTree(this._data.topRangeIndex,this._data.treeSortType),this._flattenedTree=null,this._multiSelectableNodes=null,this._$tree.link($.templates.pageTemplate,this._rootNode);var i=this._getMultiSelectState();if(i)for(var n=function(t){var e=i.ranges[t],n=r._getMultiSelectableNodes().filter((function(t){return t.data.id===e.id}))[0];n&&(r._setNodeMultiSelectEnabled(n,e.multiSelectEnabled),r._setNodeMultiSelected(n,e.multiSelected))},r=this,o=0;o<i.ranges.length;o++)n(o);this._data.autoExpand&&this.getAllNodes().forEach((function(t,i){e._setNodeExpanded(t,!0)}))}},e.prototype._getMultiSelectState=function(){return this._data.helper?this._data.helper.getMultiSelectState():null},e.prototype.data=function(){return{autoExpand:!1,branchNodesExpandOnClick:!0,branchNodesSelectable:!0,helper:null,topRangeIndex:0,treeSortType:a.TreeSortType.NONE}},e.prototype.allNodesSelected=function(){var t=this._getMultiSelectableNodes(),e=this.getMultiSelectedNodes();return t.length===e.length},e.prototype._getMultiSelectableNodes=function(){var t=this;if(this._multiSelectableNodes)return this._multiSelectableNodes;var e=this.getAllNodes();return e?this._multiSelectableNodes=e.filter((function(e){return t._nodeIsMultiSelectable(e)})):[]},e.prototype._nodeIsMultiSelectable=function(t){return!!(t.data.type===o.TreeNodeType.MANIFEST&&t.nodes&&t.nodes.length>0||t.data.type===o.TreeNodeType.RANGE)},e.prototype.getAllNodes=function(){return this._flattenedTree?this._flattenedTree:this._data.helper?this._flattenedTree=this._data.helper.getFlattenedTree(this._rootNode):[]},e.prototype.getMultiSelectedNodes=function(){var t=this;return this.getAllNodes().filter((function(e){return t._nodeIsMultiSelectable(e)&&e.multiSelected}))},e.prototype.getNodeById=function(t){return this.getAllNodes().filter((function(e){return e.id===t}))[0]},e.prototype.expandParents=function(t,e){t&&t.parentNode&&(this._setNodeExpanded(t.parentNode,e),this.expandParents(t.parentNode,e))},e.prototype._setNodeSelected=function(t,e){$.observable(t).setProperty("selected",e)},e.prototype._setNodeExpanded=function(t,e){$.observable(t).setProperty("expanded",e)},e.prototype._setNodeMultiSelected=function(t,e){$.observable(t).setProperty("multiSelected",e)},e.prototype._setNodeMultiSelectEnabled=function(t,e){$.observable(t).setProperty("multiSelectEnabled",e)},e.prototype.selectPath=function(t){if(this._rootNode){var e=t.split("/");e.length>=1&&e.shift();var i=this.getNodeByPath(this._rootNode,e);this.selectNode(i)}},e.prototype.deselectCurrentNode=function(){this.selectedNode&&this._setNodeSelected(this.selectedNode,!1)},e.prototype.selectNode=function(t){this._rootNode&&(this.deselectCurrentNode(),this.selectedNode=t,this._setNodeSelected(this.selectedNode,!0))},e.prototype.expandNode=function(t,e){this._rootNode&&this._setNodeExpanded(t,e)},e.prototype.getNodeByPath=function(t,e){if(0===e.length)return t;var i=Number(e.shift()),n=t.nodes[i];return this.getNodeByPath(n,e)},e.prototype.show=function(){this._$element.show()},e.prototype.hide=function(){this._$element.hide()},e.prototype._resize=function(){},e}(i(8).BaseComponent);e.TreeComponent=s;var l=function(){function t(){}return t.TREE_NODE_MULTISELECTED="treeNodeMultiSelected",t.TREE_NODE_SELECTED="treeNodeSelected",t}();e.Events=l},function(t,e){t.exports=n},function(t,e){t.exports=r},function(t,e){t.exports=o},function(t,e){t.exports=a},function(t,e,i){"use strict";i.r(e),i.d(e,"BaseComponent",(function(){return n}));var n=function(){function t(t){this.options=t,this.options.data=Object.assign({},this.data(),t.data)}return t.prototype._init=function(){return this.el=this.options.target,this.el?(this.el.innerHTML="",!0):(console.warn("element not found"),!1)},t.prototype.data=function(){return{}},t.prototype.on=function(t,e,i){var n=this._e||(this._e={});(n[t]||(n[t]=[])).push({fn:e,ctx:i})},t.prototype.fire=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=[].slice.call(arguments,1),r=((this._e||(this._e={}))[t]||[]).slice(),o=0,a=r.length;o<a;o++)r[o].fn.apply(r[o].ctx,n)},t.prototype._resize=function(){},t.prototype.set=function(t){},t}()},function(t,e,i){"use strict";i.r(e);var n,r,o,a,s,l,u,c,h,p,f=function(t){this.isVisible=!0;var e=t.on.match(/.*xywh=(\d*),(\d*),(\d*),(\d*)/);this.x=Number(e[1]),this.y=Number(e[2]),this.width=Number(e[3]),this.height=Number(e[4]),this.chars=t.resource.chars},d=function(){function t(t,e){this.rects=[],this.canvasIndex=e,this.addRect(t)}return t.prototype.addRect=function(t){var e=new f(t);e.canvasIndex=this.canvasIndex,e.index=this.rects.length,this.rects.push(e),this.rects.sort((function(t,e){return t.index-e.index}))},t}(),_=i(0),g=function(){function t(){this.isEnabled=!1,this.ranges=[],this.canvases=[]}return t.prototype.allCanvasesSelected=function(){return this.canvases.length>0&&this.getAllSelectedCanvases().length===this.canvases.length},t.prototype.allRangesSelected=function(){return this.ranges.length>0&&this.getAllSelectedRanges().length===this.ranges.length},t.prototype.allSelected=function(){return this.allRangesSelected()&&this.allCanvasesSelected()},t.prototype.getAll=function(){return this.canvases.concat(this.ranges)},t.prototype.getAllSelectedCanvases=function(){return this.canvases.filter((function(t){return t.multiSelected}))},t.prototype.getAllSelectedRanges=function(){return this.ranges.filter((function(t){return t.multiSelected}))},t.prototype.getCanvasById=function(t){return this.canvases.filter((function(e){return _.Utils.normaliseUrl(e.id)===_.Utils.normaliseUrl(t)}))[0]},t.prototype.getCanvasesByIds=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];e.push(this.getCanvasById(n))}return e},t.prototype.getRangeCanvases=function(t){var e=t.getCanvasIds();return this.getCanvasesByIds(e)},t.prototype.selectAll=function(t){this.selectRanges(this.ranges,t),this.selectCanvases(this.canvases,t)},t.prototype.selectCanvas=function(t,e){this.canvases.filter((function(e){return e.id===t.id}))[0].multiSelected=e},t.prototype.selectAllCanvases=function(t){this.selectCanvases(this.canvases,t)},t.prototype.selectCanvases=function(t,e){for(var i=0;i<t.length;i++)t[i].multiSelected=e},t.prototype.selectRange=function(t,e){var i=this.ranges.filter((function(e){return e.id===t.id}))[0];i.multiSelected=e;var n=this.getRangeCanvases(i);this.selectCanvases(n,e)},t.prototype.selectAllRanges=function(t){this.selectRanges(this.ranges,t)},t.prototype.selectRanges=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];n.multiSelected=e;var r=this.getCanvasesByIds(n.getCanvasIds());this.selectCanvases(r,e)}},t.prototype.setEnabled=function(t){this.isEnabled=t;for(var e=this.getAll(),i=0;i<e.length;i++){var n=e[i];n.multiSelectEnabled=this.isEnabled,t||(n.multiSelected=!1)}},t}(),E=function(){function t(t,e){this.items=[],this.resource=t,this.label=e}return t.prototype.addItem=function(t){this.items.push(t)},t.prototype.addMetadata=function(t,e){void 0===e&&(e=!1);for(var i=0;i<t.length;i++){var n=t[i];n.isRootLevel=e,this.addItem(n)}},t}();!function(t){t.DATE="date",t.NONE="none"}(n||(n={})),function(t){t.BOOKMARKING="oa:bookmarking",t.CLASSIFYING="oa:classifying",t.COMMENTING="oa:commenting",t.DESCRIBING="oa:describing",t.EDITING="oa:editing",t.HIGHLIGHTING="oa:highlighting",t.IDENTIFYING="oa:identifying",t.LINKING="oa:linking",t.MODERATING="oa:moderating",t.PAINTING="sc:painting",t.QUESTIONING="oa:questioning",t.REPLYING="oa:replying",t.TAGGING="oa:tagging",t.TRANSCRIBING="oad:transcribing"}(r||(r={})),function(t){t.AUTO_ADVANCE="auto-advance",t.CONTINUOUS="continuous",t.FACING_PAGES="facing-pages",t.HIDDEN="hidden",t.INDIVIDUALS="individuals",t.MULTI_PART="multi-part",t.NO_NAV="no-nav",t.NON_PAGED="non-paged",t.PAGED="paged",t.REPEAT="repeat",t.SEQUENCE="sequence",t.THUMBNAIL_NAV="thumbnail-nav",t.TOGETHER="together",t.UNORDERED="unordered"}(o||(o={})),function(t){t.CANVAS="canvas",t.CHOICE="choice",t.CONTENT_AS_TEXT="contentastext",t.DOCUMENT="document",t.IMAGE="image",t.MOVING_IMAGE="movingimage",t.PDF="pdf",t.PHYSICAL_OBJECT="physicalobject",t.SOUND="sound",t.TEXTUALBODY="textualbody",t.VIDEO="video"}(a||(a={})),function(t){t.ANNOTATION="annotation",t.CANVAS="canvas",t.COLLECTION="collection",t.MANIFEST="manifest",t.RANGE="range",t.SEQUENCE="sequence"}(s||(s={})),function(t){t.AUDIO_MP4="audio/mp4",t.CORTO="application/corto",t.DRACO="application/draco",t.GLTF="model/gltf+json",t.JPG="image/jpeg",t.M3U8="application/vnd.apple.mpegurl",t.MP3="audio/mp3",t.MPEG_DASH="application/dash+xml",t.OBJ="text/plain",t.PDF="application/pdf",t.PLY="application/ply",t.THREEJS="application/vnd.threejs+json",t.VIDEO_MP4="video/mp4",t.WEBM="video/webm"}(l||(l={})),function(t){t.DOC="application/msword",t.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",t.PDF="application/pdf"}(u||(u={})),function(t){t.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",t.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",t.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",t.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",t.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",t.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",t.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",t.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",t.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",t.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",t.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",t.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",t.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",t.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",t.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",t.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",t.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",t.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",t.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",t.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",t.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",t.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",t.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",t.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",t.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",t.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",t.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",t.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",t.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",t.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",t.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",t.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",t.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",t.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",t.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",t.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",t.SEARCH_0="http://iiif.io/api/search/0/search",t.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",t.SEARCH_1="http://iiif.io/api/search/1/search",t.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",t.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",t.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",t.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",t.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",t.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",t.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"}(c||(c={})),function(t){t.BOTTOM_TO_TOP="bottom-to-top",t.LEFT_TO_RIGHT="left-to-right",t.RIGHT_TO_LEFT="right-to-left",t.TOP_TO_BOTTOM="top-to-bottom"}(h||(h={})),function(t){t.CONTINUOUS="continuous",t.INDIVIDUALS="individuals",t.NON_PAGED="non-paged",t.PAGED="paged",t.TOP="top"}(p||(p={}));var v=function(){function t(){}return t.manifestNotLoaded="Manifest has not loaded yet",t}(),y=function(){function t(t){this.options=t,this.iiifResource=this.options.iiifResource,this.manifestUri=this.options.manifestUri,this.manifest=this.options.manifest,this.collectionIndex=this.options.collectionIndex||0,this.manifestIndex=this.options.manifestIndex||0,this.sequenceIndex=this.options.sequenceIndex||0,this.canvasIndex=this.options.canvasIndex||0}return t.prototype.getAutoCompleteService=function(){var t=this.getSearchService();return t?t.getService(c.SEARCH_0_AUTO_COMPLETE):null},t.prototype.getAttribution=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var t=this.manifest.getAttribution();return t?_.LanguageMap.getValue(t,this.options.locale):null},t.prototype.getCanvases=function(){return this.getCurrentSequence().getCanvases()},t.prototype.getCanvasById=function(t){return this.getCurrentSequence().getCanvasById(t)},t.prototype.getCanvasesById=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],r=this.getCanvasById(n);r&&e.push(r)}return e},t.prototype.getCanvasByIndex=function(t){return this.getCurrentSequence().getCanvasByIndex(t)},t.prototype.getCanvasIndexById=function(t){return this.getCurrentSequence().getCanvasIndexById(t)},t.prototype.getCanvasIndexByLabel=function(t){var e=this.getManifestType()===_.ManifestType.MANUSCRIPT;return this.getCurrentSequence().getCanvasIndexByLabel(t,e)},t.prototype.getCanvasRange=function(t,e){var i=this.getCanvasRanges(t);if(e){for(var n=0;n<i.length;n++){var r=i[n];if(r.path===e)return r}return null}return i[0]},t.prototype.getCanvasRanges=function(t){if(!this.manifest)throw new Error(v.manifestNotLoaded);return t.ranges?t.ranges:(t.ranges=this.manifest.getAllRanges().filter((function(e){return e.getCanvasIds().some((function(e){return _.Utils.normaliseUrl(e)===_.Utils.normaliseUrl(t.id)}))})),t.ranges)},t.prototype.getCollectionIndex=function(t){if(!t.parentCollection||t.parentCollection.parentCollection)return t.parentCollection?t.parentCollection.index:void 0},t.prototype.getCurrentCanvas=function(){return this.getCurrentSequence().getCanvasByIndex(this.canvasIndex)},t.prototype.getCurrentSequence=function(){return this.getSequenceByIndex(this.sequenceIndex)},t.prototype.getDescription=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var t=this.manifest.getDescription();return t?_.LanguageMap.getValue(t,this.options.locale):null},t.prototype.getLabel=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var t=this.manifest.getLabel();return t?_.LanguageMap.getValue(t,this.options.locale):null},t.prototype.getLastCanvasLabel=function(t){return this.getCurrentSequence().getLastCanvasLabel(t)},t.prototype.getFirstPageIndex=function(){return 0},t.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},t.prototype.getLicense=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getLicense()},t.prototype.getLogo=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getLogo()},t.prototype.getManifestType=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var t=this.manifest.getManifestType();return t===_.ManifestType.EMPTY&&(t=_.ManifestType.MONOGRAPH),t},t.prototype.getMetadata=function(t){if(!this.manifest)throw new Error(v.manifestNotLoaded);var e=[],i=this.manifest.getMetadata(),n=new E(this.manifest),r=this.options.locale;i&&i.length&&n.addMetadata(i,!0),this.manifest.getDescription().length&&((o=new _.LabelValuePair(r)).label=[new _.Language("description",r)],o.value=this.manifest.getDescription(),o.isRootLevel=!0,n.addItem(o)),this.manifest.getAttribution().length&&((o=new _.LabelValuePair(r)).label=[new _.Language("attribution",r)],o.value=this.manifest.getAttribution(),o.isRootLevel=!0,n.addItem(o));var o,a=this.manifest.getLicense();if(a){var s={label:"license",value:t&&t.licenseFormatter?t.licenseFormatter.format(a):a};(o=new _.LabelValuePair(r)).parse(s),o.isRootLevel=!0,n.addItem(o)}return this.manifest.getLogo()&&(s={label:"logo",value:'<img src="'+this.manifest.getLogo()+'"/>'},(o=new _.LabelValuePair(r)).parse(s),o.isRootLevel=!0,n.addItem(o)),e.push(n),t?this._parseMetadataOptions(t,e):e},t.prototype.getRequiredStatement=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var t=this.manifest.getRequiredStatement();return t?{label:t.getLabel(),value:t.getValue()}:null},t.prototype._parseMetadataOptions=function(t,e){var i=this.getCurrentSequence(),n=i.getMetadata();if(n&&n.length){var r=new E(i);r.addMetadata(n),e.push(r)}if(t.range){var o=this._getRangeMetadata([],t.range);o=o.reverse(),e=e.concat(o)}if(t.canvases&&t.canvases.length)for(var a=0;a<t.canvases.length;a++){var s=t.canvases[a],l=s.getMetadata();if(l&&l.length){var u=new E(s);u.addMetadata(s.getMetadata()),e.push(u)}for(var c=s.getImages(),h=0;h<c.length;h++){var p=c[h],f=p.getMetadata();if(f&&f.length){var d=new E(p);d.addMetadata(f),e.push(d)}}}return e},t.prototype._getRangeMetadata=function(t,e){var i=e.getMetadata();if(i&&i.length){var n=new E(e);n.addMetadata(i),t.push(n)}else if(e.parentRange)return this._getRangeMetadata(t,e.parentRange);return t},t.prototype.getMultiSelectState=function(){return this._multiSelectState||(this._multiSelectState=new g,this._multiSelectState.ranges=this.getRanges().slice(0),this._multiSelectState.canvases=this.getCurrentSequence().getCanvases().slice(0)),this._multiSelectState},t.prototype.getCurrentRange=function(){return this.rangeId?this.getRangeById(this.rangeId):null},t.prototype.getPosterCanvas=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getPosterCanvas()},t.prototype.getPosterImage=function(){var t=this.getPosterCanvas();if(t){var e=t.getContent();if(e&&e.length)return e[0].getBody()[0].id}return null},t.prototype.getPreviousRange=function(t){var e;if(e=t||this.getCurrentRange()){var i=this.getFlattenedTree();if(i)for(var n=0;n<i.length;n++){var r=i[n];if(r&&r.data.id===e.id){for(;n>0;)return i[--n].data;break}}}return null},t.prototype.getNextRange=function(t){var e;if(e=t||this.getCurrentRange()){var i=this.getFlattenedTree();if(i)for(var n=0;n<i.length;n++){var r=i[n];if(r&&r.data.id===e.id){for(;n<i.length-1;){var o=i[++n];if(o.data.canvases&&o.data.canvases.length)return o.data}break}}}return null},t.prototype.getFlattenedTree=function(t){var e;return(e=t||this.getTree())?this._flattenTree(e,"nodes"):null},t.prototype._flattenTree=function(t,e){var i=this,n=[t];return t[e]&&t[e].length>0?n.concat(t[e].map((function(t){return i._flattenTree(t,e)})).reduce((function(t,e){return t.concat(e)}),[])):n},t.prototype.getRanges=function(){return this.manifest.getAllRanges()},t.prototype.getRangeByPath=function(t){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getRangeByPath(t)},t.prototype.getRangeById=function(t){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getRangeById(t)},t.prototype.getRangeCanvases=function(t){var e=t.getCanvasIds();return this.getCanvasesById(e)},t.prototype.getRelated=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getRelated()},t.prototype.getSearchService=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getService(c.SEARCH_0)},t.prototype.getSeeAlso=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getSeeAlso()},t.prototype.getSequenceByIndex=function(t){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getSequenceByIndex(t)},t.prototype.getShareServiceUrl=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var t=null,e=this.manifest.getService(c.SHARE_EXTENSIONS);return e&&(e.length&&(e=e[0]),t=e.__jsonld.shareUrl),t},t.prototype._getSortedTreeNodesByDate=function(t,e){var i=this.getFlattenedTree(e);if(i){var n=i.filter((function(t){return t.data.type===_.TreeNodeType.MANIFEST}));this.createDecadeNodes(t,i),this.sortDecadeNodes(t),this.createYearNodes(t,i),this.sortYearNodes(t),this.createMonthNodes(t,n),this.sortMonthNodes(t),this.createDateNodes(t,n),this.pruneDecadeNodes(t)}},t.prototype.getStartCanvasIndex=function(){return this.getCurrentSequence().getStartCanvasIndex()},t.prototype.getThumbs=function(t,e){return this.getCurrentSequence().getThumbs(t,e)},t.prototype.getTopRanges=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getTopRanges()},t.prototype.getTotalCanvases=function(){return this.getCurrentSequence().getTotalCanvases()},t.prototype.getTrackingLabel=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getTrackingLabel()},t.prototype._getTopRanges=function(){return this.iiifResource.getTopRanges()},t.prototype.getTree=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=n.NONE),!this.iiifResource)return null;var i;if(this.iiifResource.isCollection())i=this.iiifResource.getDefaultTree();else{var r=this._getTopRanges(),o=new _.TreeNode;if(o.label="root",o.data=this.iiifResource,!r.length)return o;i=r[t].getTree(o)}var a=new _.TreeNode;switch(e.toString()){case n.DATE.toString():if(this.treeHasNavDates(i)){this._getSortedTreeNodesByDate(a,i);break}default:a=i}return a},t.prototype.treeHasNavDates=function(t){var e=this.getFlattenedTree(t);return!!e&&e.some((function(t){return!isNaN(t.navDate)}))},t.prototype.getViewingDirection=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var t=this.getCurrentSequence().getViewingDirection();return t||(t=this.manifest.getViewingDirection()),t},t.prototype.getViewingHint=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var t=this.getCurrentSequence().getViewingHint();return t||(t=this.manifest.getViewingHint()),t},t.prototype.hasParentCollection=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return!!this.manifest.parentCollection},t.prototype.hasRelatedPage=function(){var t=this.getRelated();return!!t&&(t.length&&(t=t[0]),"text/html"===t.format)},t.prototype.hasResources=function(){return this.getCurrentCanvas().getResources().length>0},t.prototype.isBottomToTop=function(){var t=this.getViewingDirection();return!!t&&t===h.BOTTOM_TO_TOP},t.prototype.isCanvasIndexOutOfRange=function(t){return this.getCurrentSequence().isCanvasIndexOutOfRange(t)},t.prototype.isContinuous=function(){var t=this.getViewingHint();return!!t&&t===p.CONTINUOUS},t.prototype.isFirstCanvas=function(t){return void 0!==t?this.getCurrentSequence().isFirstCanvas(t):this.getCurrentSequence().isFirstCanvas(this.canvasIndex)},t.prototype.isHorizontallyAligned=function(){return this.isLeftToRight()||this.isRightToLeft()},t.prototype.isLastCanvas=function(t){return void 0!==t?this.getCurrentSequence().isLastCanvas(t):this.getCurrentSequence().isLastCanvas(this.canvasIndex)},t.prototype.isLeftToRight=function(){var t=this.getViewingDirection();return!!t&&t===h.LEFT_TO_RIGHT},t.prototype.isMultiCanvas=function(){return this.getCurrentSequence().isMultiCanvas()},t.prototype.isMultiSequence=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.isMultiSequence()},t.prototype.isPaged=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var t=this.getViewingHint();return t?t===p.PAGED:this.manifest.isPagingEnabled()},t.prototype.isPagingAvailable=function(){return this.isPagingEnabled()&&this.getTotalCanvases()>2},t.prototype.isPagingEnabled=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.isPagingEnabled()||this.getCurrentSequence().isPagingEnabled()},t.prototype.isRightToLeft=function(){var t=this.getViewingDirection();return!!t&&t===h.RIGHT_TO_LEFT},t.prototype.isTopToBottom=function(){var t=this.getViewingDirection();return!!t&&t===h.TOP_TO_BOTTOM},t.prototype.isTotalCanvasesEven=function(){return this.getCurrentSequence().isTotalCanvasesEven()},t.prototype.isUIEnabled=function(t){if(!this.manifest)throw new Error(v.manifestNotLoaded);var e=this.manifest.getService(c.UI_EXTENSIONS);if(e){var i=e.getProperty("disableUI");if(i&&(-1!==i.indexOf(t)||-1!==i.indexOf(t.toLowerCase())))return!1}return!0},t.prototype.isVerticallyAligned=function(){return this.isTopToBottom()||this.isBottomToTop()},t.prototype.createDateNodes=function(t,e){for(var i=0;i<e.length;i++){var n=e[i],r=this.getNodeYear(n),o=this.getNodeMonth(n),a=new _.TreeNode;a.id=n.id,a.label=this.getNodeDisplayDate(n),a.data=n.data,a.data.type=_.TreeNodeType.MANIFEST,a.data.year=r,a.data.month=o;var s=this.getDecadeNode(t,r);if(s){var l=this.getYearNode(s,r);if(l){var u=this.getMonthNode(l,o);u&&u.addNode(a)}}}},t.prototype.createDecadeNodes=function(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.navDate){var r=this.getNodeYear(n),o=Number(r.toString().substr(0,3)+"9");if(!this.getDecadeNode(t,r)){var a=new _.TreeNode;a.label=r+" - "+o,a.navDate=n.navDate,a.data.startYear=r,a.data.endYear=o,t.addNode(a)}}}},t.prototype.createMonthNodes=function(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.navDate){var r=this.getNodeYear(n),o=this.getNodeMonth(n),a=this.getDecadeNode(t,r),s=null;if(a&&(s=this.getYearNode(a,r)),a&&s&&!this.getMonthNode(s,o)){var l=new _.TreeNode;l.label=this.getNodeDisplayMonth(n),l.navDate=n.navDate,l.data.year=r,l.data.month=o,s.addNode(l)}}}},t.prototype.createYearNodes=function(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.navDate){var r=this.getNodeYear(n),o=this.getDecadeNode(t,r);if(o&&!this.getYearNode(o,r)){var a=new _.TreeNode;a.label=r.toString(),a.navDate=n.navDate,a.data.year=r,o.addNode(a)}}}},t.prototype.getDecadeNode=function(t,e){for(var i=0;i<t.nodes.length;i++){var n=t.nodes[i];if(e>=n.data.startYear&&e<=n.data.endYear)return n}return null},t.prototype.getMonthNode=function(t,e){for(var i=0;i<t.nodes.length;i++){var n=t.nodes[i];if(e===this.getNodeMonth(n))return n}return null},t.prototype.getNodeDisplayDate=function(t){return t.navDate.toDateString()},t.prototype.getNodeDisplayMonth=function(t){return["January","February","March","April","May","June","July","August","September","October","November","December"][t.navDate.getMonth()]},t.prototype.getNodeMonth=function(t){return t.navDate.getMonth()},t.prototype.getNodeYear=function(t){return t.navDate.getFullYear()},t.prototype.getYearNode=function(t,e){for(var i=0;i<t.nodes.length;i++){var n=t.nodes[i];if(e===this.getNodeYear(n))return n}return null},t.prototype.pruneDecadeNodes=function(t){for(var e=[],i=0;i<t.nodes.length;i++){var n=t.nodes[i];n.nodes.length||e.push(n)}for(var r=0;r<e.length;r++){var o=e[r],a=t.nodes.indexOf(o);a>-1&&t.nodes.splice(a,1)}},t.prototype.sortDecadeNodes=function(t){t.nodes=t.nodes.sort((function(t,e){return t.data.startYear-e.data.startYear}))},t.prototype.sortMonthNodes=function(t){for(var e=this,i=0;i<t.nodes.length;i++)for(var n=t.nodes[i],r=0;r<n.nodes.length;r++){var o=n.nodes[r];o.nodes=o.nodes.sort((function(t,i){return e.getNodeMonth(t)-e.getNodeMonth(i)}))}},t.prototype.sortYearNodes=function(t){for(var e=this,i=0;i<t.nodes.length;i++){var n=t.nodes[i];n.nodes=n.nodes.sort((function(t,i){return e.getNodeYear(t)-e.getNodeYear(i)}))}},t}(),T=function(){function t(t){this._options=t,this._options.locale=this._options.locale||"en-GB"}return t.prototype.bootstrap=function(t,e){var i=this;return new Promise((function(n,r){t&&e&&(n=t,r=e),_.Utils.loadManifest(i._options.manifestUri).then((function(t){i._loaded(i,t,n,r)}))}))},t.prototype._loaded=function(t,e,i,n){var r=_.Utils.parseManifest(e,{locale:t._options.locale});if(r){t._options.iiifResource||(t._options.iiifResource=r);var o=t._options.collectionIndex,a=t._options.manifestIndex;if(r.getIIIFResourceType()===s.COLLECTION){var l=r.getManifests(),u=r.getCollections();l.length||void 0!==o||(o=0),void 0!==o&&u&&u.length?r.getCollectionByIndex(o).then((function(e){e||n("Collection index not found"),0===e.getTotalManifests()&&0===a&&e.getTotalCollections()>0?(t._options.collectionIndex=0,t._options.manifestUri=e.id,t.bootstrap(i,n)):void 0!==a&&e.getManifestByIndex(a).then((function(e){t._options.manifest=e;var n=new y(t._options);i(n)}))})):r.getManifestByIndex(t._options.manifestIndex).then((function(e){t._options.manifest=e;var n=new y(t._options);i(n)}))}else{t._options.manifest=r;var c=new y(t._options);i(c)}}else console.error("Unable to load IIIF resource")},t}(),m=i(1),I=function(){function t(t,e){this.authHoldingPage=null,this.clickThroughService=null,this.externalService=null,this.isProbed=!1,this.isResponseHandled=!1,this.kioskService=null,this.loginService=null,this.logoutService=null,this.probeService=null,this.restrictedService=null,this.tokenService=null,t.externalResource=this,this.dataUri=this._getDataUri(t),this.index=t.index,this.authAPIVersion=e.authApiVersion,this._parseAuthServices(t),this._parseDimensions(t)}return t.prototype._getImageServiceDescriptor=function(t){for(var e=null,i=0;i<t.length;i++){var n=t[i],r=n.id;r.endsWith("/")||(r+="/"),_.Utils.isImageProfile(n.getProfile())&&(e=r+"info.json")}return e},t.prototype._getDataUri=function(t){var e=t.getContent(),i=t.getImages(),n=null;if(e&&e.length){var r=e[0].getBody();return r.length?(o=r[0].getServices()).length&&(n=this._getImageServiceDescriptor(o))?n:r[0].id:null}if(i&&i.length){var o,a=i[0].getResource();return(o=a.getServices()).length&&(n=this._getImageServiceDescriptor(o))?n:a.id}var s=t.getService(c.IXIF);return s?s.getInfoUri():t.id},t.prototype._parseAuthServices=function(t){if(.9===this.authAPIVersion)this.clickThroughService=_.Utils.getService(t,c.AUTH_0_CLICK_THROUGH),this.loginService=_.Utils.getService(t,c.AUTH_0_LOGIN),this.restrictedService=_.Utils.getService(t,c.AUTH_0_RESTRICTED),this.clickThroughService?(this.logoutService=this.clickThroughService.getService(c.AUTH_0_LOGOUT),this.tokenService=this.clickThroughService.getService(c.AUTH_0_TOKEN)):this.loginService?(this.logoutService=this.loginService.getService(c.AUTH_0_LOGOUT),this.tokenService=this.loginService.getService(c.AUTH_0_TOKEN)):this.restrictedService&&(this.logoutService=this.restrictedService.getService(c.AUTH_0_LOGOUT),this.tokenService=this.restrictedService.getService(c.AUTH_0_TOKEN));else{if(void 0!==t.isCanvas&&t.isCanvas()){var e=t.getContent();if(e&&e.length){var i=e[0].getBody();i&&i.length&&(t=i[0])}}this.clickThroughService=_.Utils.getService(t,c.AUTH_1_CLICK_THROUGH),this.loginService=_.Utils.getService(t,c.AUTH_1_LOGIN),this.externalService=_.Utils.getService(t,c.AUTH_1_EXTERNAL),this.kioskService=_.Utils.getService(t,c.AUTH_1_KIOSK),this.clickThroughService?(this.logoutService=this.clickThroughService.getService(c.AUTH_1_LOGOUT),this.tokenService=this.clickThroughService.getService(c.AUTH_1_TOKEN),this.probeService=this.clickThroughService.getService(c.AUTH_1_PROBE)):this.loginService?(this.logoutService=this.loginService.getService(c.AUTH_1_LOGOUT),this.tokenService=this.loginService.getService(c.AUTH_1_TOKEN),this.probeService=this.loginService.getService(c.AUTH_1_PROBE)):this.externalService?(this.logoutService=this.externalService.getService(c.AUTH_1_LOGOUT),this.tokenService=this.externalService.getService(c.AUTH_1_TOKEN),this.probeService=this.externalService.getService(c.AUTH_1_PROBE)):this.kioskService&&(this.logoutService=this.kioskService.getService(c.AUTH_1_LOGOUT),this.tokenService=this.kioskService.getService(c.AUTH_1_TOKEN),this.probeService=this.kioskService.getService(c.AUTH_1_PROBE))}},t.prototype._parseDimensions=function(t){var e=t.getImages();if(e&&e.length){var i=e[0].getResource();this.width=i.getWidth(),this.height=i.getHeight()}else if((e=t.getContent()).length){var n=e[0].getBody();n.length&&(this.width=n[0].getWidth(),this.height=n[0].getHeight())}},t.prototype.isAccessControlled=function(){return!!(this.clickThroughService||this.loginService||this.externalService||this.kioskService||this.probeService)},t.prototype.hasServiceDescriptor=function(){return!!this.dataUri&&this.dataUri.endsWith("info.json")},t.prototype.getData=function(t){var e=this;return e.data={},new Promise((function(i,n){if(e.dataUri)if(e.probeService){e.isProbed=!0;var r=new XMLHttpRequest;r.open("GET",e.probeService.id,!0),r.withCredentials=!0,r.onload=function(){var t=JSON.parse(r.responseText);unescape(t.contentLocation)!==e.dataUri?e.status=m.MOVED_TEMPORARILY:e.status=m.OK,i(e)},r.onerror=function(){e.status=r.status,i(e)},r.send()}else{var o="GET";if(!e.hasServiceDescriptor()){if(!e.isAccessControlled())return e.status=m.OK,void i(e);o="HEAD"}var a=new XMLHttpRequest;a.open(o,e.dataUri,!0),t&&a.setRequestHeader("Authorization","Bearer "+t.accessToken),a.onload=function(){var t=JSON.parse(a.responseText);if(t){var n=unescape(t["@id"]);e.data=t,e._parseAuthServices(e.data),n.endsWith("/info.json")&&(n=n.substr(0,n.lastIndexOf("/")));var r=e.dataUri;r&&r.endsWith("/info.json")&&(r=r.substr(0,r.lastIndexOf("/"))),n!==r&&e.loginService?e.status=m.MOVED_TEMPORARILY:e.status=m.OK,i(e)}else e.status=m.OK,i(e)},a.onerror=function(){e.status=a.status,a.responseText&&e._parseAuthServices(JSON.parse(a.responseText)),i(e)},a.send()}else n("There is no dataUri to fetch")}))},t}(),O=function(){},N=function(){},A=function(t,e){this.value=t,this.locale=e},L=function(){function t(t){this.labels=t}return t.prototype.format=function(t){return-1!=t.indexOf("<a")?t:'<a href="'+t+'">'+(this.labels[t]?this.labels[t]:t)+"</a>"},t}();i.d(e,"loadManifest",(function(){return S})),i.d(e,"AnnotationGroup",(function(){return d})),i.d(e,"AnnotationRect",(function(){return f})),i.d(e,"Bootstrapper",(function(){return T})),i.d(e,"ExternalResource",(function(){return I})),i.d(e,"Helper",(function(){return y})),i.d(e,"ILabelValuePair",(function(){return O})),i.d(e,"MetadataGroup",(function(){return E})),i.d(e,"MetadataOptions",(function(){return N})),i.d(e,"MultiSelectState",(function(){return g})),i.d(e,"Translation",(function(){return A})),i.d(e,"TreeSortType",(function(){return n})),i.d(e,"UriLabeller",(function(){return L}));var S=function(t){return new T(t).bootstrap()}}]))},83:function(t,e){t.exports="object"==typeof self?self.FormData:window.FormData}}]);