(window.webpackJsonpUV=window.webpackJsonpUV||[]).push([[9],{125:function(t,e,n){"use strict";n.r(e);var i,o=n(3),s=n(41),r=n(31),a=n(46),h=n(28),l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){function e(e){return t.call(this,e)||this}return l(e,t),e.prototype.create=function(){this.setConfig("downloadDialogue"),t.prototype.create.call(this)},e.prototype.open=function(e){t.prototype.open.call(this,e),this.addEntireFileDownloadOptions(),this.updateNoneAvailable(),this.resize()},e.prototype.isDownloadOptionAvailable=function(e){return t.prototype.isDownloadOptionAvailable.call(this,e)},e}(h.a),c=n(30),u=n(42),d=n(43),f=n(38),g=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),b=function(t){function e(e){return t.call(this,e)||this}return g(e,t),e.prototype.create=function(){this.setConfig("settingsDialogue"),t.prototype.create.call(this)},e}(f.a),y=n(39),m=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),w=function(t){function e(e){return t.call(this,e)||this}return m(e,t),e.prototype.create=function(){this.setConfig("shareDialogue"),t.prototype.create.call(this)},e.prototype.update=function(){t.prototype.update.call(this),this.code=this.extension.getEmbedScript(this.options.embedTemplate,this.currentWidth,this.currentHeight),this.$code.val(this.code)},e.prototype.resize=function(){t.prototype.resize.call(this)},e}(y.a),E=(n(86),n(7)),T=n(34),v=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),_=function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function r(t){try{h(i.next(t))}catch(t){s(t)}}function a(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}h((i=i.apply(t,e||[])).next())}))},O=function(t,e){var n,i,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&s[0]?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,i=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){r=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(6===s[0]&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=e.call(t,r)}catch(t){s=[6,t],i=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},C=function(t){function e(e){return t.call(this,e)||this}return v(e,t),e.prototype.create=function(){this.setConfig("modelViewerCenterPanel"),t.prototype.create.call(this);var e=this;this.component.subscribe(o.a.OPEN_EXTERNAL_RESOURCE,(function(t){e.openMedia(t)})),this.title=this.extension.helper.getLabel(),this.$modelViewer=$("<model-viewer auto-rotate camera-controls></model-viewer>"),this.component.publish(o.a.OPENED_MEDIA)},e.prototype.openMedia=function(t){return _(this,void 0,void 0,(function(){var e,n,i;return O(this,(function(s){switch(s.label){case 0:return[4,this.extension.getExternalResources(t)];case 1:return s.sent(),this.$content.empty(),e=null,n=this.extension.helper.getCurrentCanvas(),i=this.extension.getMediaFormats(n),e=i&&i.length?i[0].id:n.id,this.$modelViewer.attr("src",e),this.$content.append(this.$modelViewer),this.component.publish(o.a.OPENED_MEDIA),[2]}}))}))},e.prototype.resize=function(){t.prototype.resize.call(this),this.title&&this.$title.text(Object(E.c)(this.title)),this.$modelViewer&&(this.$modelViewer.width(this.$content.width()),this.$modelViewer.height(this.$content.height()))},e}(T.a),V=n(0),N=n(4),A=n(1),S=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.create=function(){var e=this;t.prototype.create.call(this),this.component.subscribe(o.a.CANVAS_INDEX_CHANGED,(function(t){e.viewCanvas(t)})),this.component.subscribe(o.a.THUMB_SELECTED,(function(t){e.component.publish(o.a.CANVAS_INDEX_CHANGED,t)}))},e.prototype.createModules=function(){t.prototype.createModules.call(this),this.isHeaderPanelEnabled()?this.headerPanel=new u.a(this.shell.$headerPanel):this.shell.$headerPanel.hide(),this.isLeftPanelEnabled()&&(this.leftPanel=new a.a(this.shell.$leftPanel)),this.centerPanel=new C(this.shell.$centerPanel),this.isRightPanelEnabled()&&(this.rightPanel=new d.a(this.shell.$rightPanel)),this.isFooterPanelEnabled()?this.footerPanel=new c.a(this.shell.$footerPanel):this.shell.$footerPanel.hide(),this.$downloadDialogue=$('<div class="overlay download" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$downloadDialogue),this.downloadDialogue=new p(this.$downloadDialogue),this.$shareDialogue=$('<div class="overlay share" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$shareDialogue),this.shareDialogue=new w(this.$shareDialogue),this.$settingsDialogue=$('<div class="overlay settings" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$settingsDialogue),this.settingsDialogue=new b(this.$settingsDialogue),this.isLeftPanelEnabled()?this.leftPanel.init():this.shell.$leftPanel.hide(),this.isRightPanelEnabled()?this.rightPanel.init():this.shell.$rightPanel.hide()},e.prototype.render=function(){t.prototype.render.call(this)},e.prototype.isLeftPanelEnabled=function(){return N.b.getBool(this.data.config.options.leftPanelEnabled,!0)&&(this.helper.isMultiCanvas()||this.helper.isMultiSequence())},e.prototype.bookmark=function(){t.prototype.bookmark.call(this);var e=this.helper.getCurrentCanvas(),n=new r.a;n.index=this.helper.canvasIndex,n.label=A.LanguageMap.getValue(e.getLabel()),n.thumb=e.getProperty("thumbnail"),n.title=this.helper.getLabel(),n.trackingLabel=window.trackingLabel,n.type=V.a.PHYSICAL_OBJECT,this.fire(o.a.BOOKMARK,n)},e.prototype.getEmbedScript=function(t,e,n){var i=this.getAppUri()+"#?manifest="+this.helper.manifestUri+"&c="+this.helper.collectionIndex+"&m="+this.helper.manifestIndex+"&s="+this.helper.sequenceIndex+"&cv="+this.helper.canvasIndex;return N.n.format(t,i,e.toString(),n.toString())},e}(s.a);e.default=x},24:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function(){function t(t){this.value=t}return t.prototype.toString=function(){return this.value},t.image=new t("image"),t.page=new t("page"),t}()},26:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function(){function t(){}return t.namespace="openseadragonExtension.",t.CURRENT_VIEW_URI=t.namespace+"currentViewUri",t.IMAGE_SEARCH=t.namespace+"imageSearch",t.MODE_CHANGED=t.namespace+"modeChanged",t.NEXT_SEARCH_RESULT=t.namespace+"nextSearchResult",t.NEXT_IMAGES_SEARCH_RESULT_UNAVAILABLE=t.namespace+"nextImagesSearchResultUnavailable",t.PREV_IMAGES_SEARCH_RESULT_UNAVAILABLE=t.namespace+"prevImagesSearchResultUnavailable",t.PAGE_SEARCH=t.namespace+"pageSearch",t.PAGING_TOGGLED=t.namespace+"pagingToggled",t.PREV_SEARCH_RESULT=t.namespace+"prevSearchResult",t.PRINT=t.namespace+"print",t.ROTATE=t.namespace+"rotate",t.OPENSEADRAGON_ANIMATION_FINISH=t.namespace+"animationFinish",t.OPENSEADRAGON_ANIMATION_START=t.namespace+"animationStart",t.OPENSEADRAGON_ANIMATION=t.namespace+"animation",t.OPENSEADRAGON_OPEN=t.namespace+"open",t.OPENSEADRAGON_RESIZE=t.namespace+"resize",t.OPENSEADRAGON_ROTATION=t.namespace+"rotationChanged",t.SEARCH_PREVIEW_FINISH=t.namespace+"searchPreviewFinish",t.SEARCH_PREVIEW_START=t.namespace+"searchPreviewStart",t.SEARCH=t.namespace+"search",t.XYWH_CHANGED=t.namespace+"xywhChanged",t.ZOOM_IN=t.namespace+"zoomIn",t.ZOOM_OUT=t.namespace+"zoomOut",t}()},27:function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.CANVAS_RENDERINGS="canvasRenderings",t.CURRENT_VIEW="currentView",t.ENTIRE_DOCUMENT_AS_PDF="entireDocumentAsPdf",t.ENTIRE_DOCUMENT_AS_TEXT="entireDocumentAsText",t.ENTIRE_FILE_AS_ORIGINAL="entireFileAsOriginal",t.IMAGE_RENDERINGS="imageRenderings",t.MANIFEST_RENDERINGS="manifestRenderings",t.RANGE_RENDERINGS="rangeRenderings",t.SELECTION="selection",t.UNKNOWN="unknown",t.WHOLE_IMAGE_HIGH_RES="wholeImageHighRes",t.WHOLE_IMAGE_LOW_RES="wholeImageLowRes",t.WHOLE_IMAGES_HIGH_RES="wholeImagesHighRes"}(i||(i={}))},28:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var i,o=n(3),s=n(22),r=n(27),a=n(4),h=n(1),l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){function e(e){return t.call(this,e)||this}return l(e,t),e.prototype.create=function(){var e=this;this.setConfig("downloadDialogue"),t.prototype.create.call(this),this.openCommand=o.a.SHOW_DOWNLOAD_DIALOGUE,this.closeCommand=o.a.HIDE_DOWNLOAD_DIALOGUE,this.component.subscribe(this.openCommand,(function(t){e.open(t)})),this.component.subscribe(this.closeCommand,(function(){e.close()})),this.$title=$("<h1>"+this.content.title+"</h1>"),this.$content.append(this.$title),this.$noneAvailable=$('<div class="noneAvailable">'+this.content.noneAvailable+"</div>"),this.$content.append(this.$noneAvailable),this.$downloadOptions=$('<ol class="options"></ol>'),this.$content.append(this.$downloadOptions),this.$footer=$('<div class="footer"></div>'),this.$content.append(this.$footer),this.$termsOfUseButton=$('<a href="#">'+this.extension.data.config.content.termsOfUse+"</a>"),this.$footer.append(this.$termsOfUseButton),this.$termsOfUseButton.onPressed((function(){e.component.publish(o.a.SHOW_TERMS_OF_USE)})),this.$element.hide(),this.updateTermsOfUseButton()},e.prototype.addEntireFileDownloadOptions=function(){if(this.isDownloadOptionAvailable(r.a.ENTIRE_FILE_AS_ORIGINAL)){this.$downloadOptions.empty();for(var t=this.extension.helper.getCurrentCanvas(),e=!1,n=t.getRenderings(),i=0;i<n.length;i++){var o=n[i],s=o.getFormat(),a="";s&&(a=s.toString()),this.addEntireFileDownloadOption(o.id,h.LanguageMap.getValue(o.getLabel()),a),e=!0}if(!e){var l=!1,p=t.getContent();for(i=0;i<p.length;i++){var c=p[i].getBody();if(c.length)(a=c[0].getFormat())&&(this.addEntireFileDownloadOption(c[0].id,"",a.toString()),l=!0)}l||this.addEntireFileDownloadOption(t.id,"","")}}},e.prototype.addEntireFileDownloadOption=function(t,e,n){var i;i=n?a.f.simplifyMimeType(n):this.getFileExtension(t),e||(e=this.content.entireFileAsOriginal),i&&(e+=" ("+i+")"),this.$downloadOptions.append('<li><a href="'+t+'" target="_blank" download tabindex="0">'+e+"</li>")},e.prototype.resetDynamicDownloadOptions=function(){this.renderingUrls=[],this.renderingUrlsCount=0,this.$downloadOptions.find("li.dynamic").remove()},e.prototype.getDownloadOptionsForRenderings=function(t,e,n){for(var i=t.getRenderings(),o=[],s=0;s<i.length;s++){var r=i[s];if(r){var l=h.LanguageMap.getValue(r.getLabel(),this.extension.getLocale()),p="downloadOption"+ ++this.renderingUrlsCount;l?l+=" ({0})":l=e;var c=a.f.simplifyMimeType(r.getFormat().toString());l=a.n.format(l,c),this.renderingUrls[p]=r.id;var u=$('<li class="option dynamic"><input id="'+p+'" data-mime="'+c+'" title="'+l+'" type="radio" name="downloadOptions" tabindex="0" /><label for="'+p+'">'+l+"</label></li>");o.push({type:n,button:u})}}return o},e.prototype.getSelectedOption=function(){return this.$downloadOptions.find("li.option input:checked")},e.prototype.getCurrentResourceId=function(){return this.extension.helper.getCurrentCanvas().externalResource.data.id},e.prototype.getCurrentResourceFormat=function(){var t=this.getCurrentResourceId();return t.substr(t.lastIndexOf(".")+1).toLowerCase()},e.prototype.updateNoneAvailable=function(){this.$downloadOptions.find("li:visible").length?this.$noneAvailable.hide():this.$noneAvailable.show()},e.prototype.updateTermsOfUseButton=function(){var t=this.extension.helper.getRequiredStatement();a.b.getBool(this.extension.data.config.options.termsOfUseEnabled,!1)&&t&&t.value?this.$termsOfUseButton.show():this.$termsOfUseButton.hide()},e.prototype.getFileExtension=function(t){var e=t.split(".").pop();return e.length>5||-1!==e.indexOf("/")?null:e},e.prototype.isMediaDownloadEnabled=function(){return this.extension.helper.isUIEnabled("mediaDownload")},e.prototype.isDownloadOptionAvailable=function(t){switch(t){case r.a.ENTIRE_FILE_AS_ORIGINAL:return this.isMediaDownloadEnabled()}return!0},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.resize=function(){this.setDockedPosition()},e}(s.a)},31:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function(){}},46:function(t,e,n){"use strict";var i,o=n(4),s=n(3),r=n(23),a=n(49),h=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(e){var n=t.call(this,e,!0,!0)||this;return n.isOpen=!1,n}return h(e,t),e.prototype.create=function(){this.setConfig("contentLeftPanel"),t.prototype.create.call(this),this.$gallery=$('<div class="iiif-gallery-component"></div>'),this.$element.append(this.$gallery)},e.prototype.setup=function(){var t=this;this.galleryComponent=new a.a({target:this.$gallery[0]}),this.galleryComponent.on("thumbSelected",(function(e){t.component.publish(s.a.GALLERY_THUMB_SELECTED,e),t.component.publish(s.a.THUMB_SELECTED,e)}),!1),this.galleryComponent.on("decreaseSize",(function(){t.component.publish(s.a.GALLERY_DECREASE_SIZE)}),!1),this.galleryComponent.on("increaseSize",(function(){t.component.publish(s.a.GALLERY_INCREASE_SIZE)}),!1)},e.prototype.databind=function(){this.galleryComponent.options.data=this.galleryData,this.galleryComponent.set(this.galleryData),this.resize()},e.prototype.show=function(){var t=this;this.isOpen=!0,this.$element.show(),setTimeout((function(){t.galleryComponent.selectIndex(t.extension.helper.canvasIndex)}),10)},e.prototype.hide=function(){this.isOpen=!1,this.$element.hide()},e.prototype.resize=function(){t.prototype.resize.call(this);var e=this.$gallery.find(".main"),n=this.$gallery.find(".header");e.height(this.$element.height()-n.height())},e}(r.a),p=n(36),c=n(24),u=n(37),d=n(26),f=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.create=function(){var e=this;this.setConfig("contentLeftPanel"),t.prototype.create.call(this),this.component.subscribe(d.a.MODE_CHANGED,(function(){e.setLabel()})),this.component.subscribe(d.a.SEARCH_PREVIEW_START,(function(t){e.searchPreviewStart(t)})),this.component.subscribe(d.a.SEARCH_PREVIEW_FINISH,(function(){e.searchPreviewFinish()})),this.extension.helper.isPaged()&&this.$thumbs.addClass("paged");var n=this;$.views.helpers({separator:function(){return!n.extension.helper.isPaged()||(this.data.index-1)%2!=0}})},e.prototype.addSelectedClassToThumbs=function(t){for(var e=this.extension.getPagedIndices(t),n=0;n<e.length;n++)this.getThumbByIndex(e[n]).addClass("selected")},e.prototype.isPageModeEnabled=function(){return"function"==typeof this.extension.getMode?this.config.options.pageModeEnabled&&this.extension.getMode().toString()===c.a.page.toString():this.config.options.pageModeEnabled},e.prototype.searchPreviewStart=function(t){this.scrollToThumb(t),this.getThumbByIndex(t).addClass("searchpreview")},e.prototype.searchPreviewFinish=function(){this.scrollToThumb(this.extension.helper.canvasIndex),this.getAllThumbs().removeClass("searchpreview")},e.prototype.setLabel=function(){this.isPDF()?($(this.$thumbs).find("span.index").hide(),$(this.$thumbs).find("span.label").hide()):this.isPageModeEnabled()?($(this.$thumbs).find("span.index").hide(),$(this.$thumbs).find("span.label").show()):($(this.$thumbs).find("span.index").show(),$(this.$thumbs).find("span.label").hide())},e}(u.a),b=n(55),y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),m=function(t){function e(e){var n=t.call(this,e,!0,!0)||this;return n.isOpen=!1,n}return y(e,t),e.prototype.create=function(){this.setConfig("contentLeftPanel"),t.prototype.create.call(this),this.$tree=$('<div class="iiif-tree-component"></div>'),this.$element.append(this.$tree)},e.prototype.setup=function(){var t=this;this.treeComponent=new b.TreeComponent({target:this.$tree[0],data:this.treeData}),this.treeComponent.on("treeNodeSelected",(function(e){t.component.publish(s.a.TREE_NODE_SELECTED,e)}),!1),this.treeComponent.on("treeNodeMultiSelected",(function(e){t.component.publish(s.a.TREE_NODE_MULTISELECTED,e)}),!1)},e.prototype.databind=function(){var t=this;setTimeout((function(){t.treeComponent.set(t.treeData),t.resize()}),1)},e.prototype.show=function(){this.isOpen=!0,this.$element.show()},e.prototype.hide=function(){this.isOpen=!1,this.$element.hide()},e.prototype.selectNode=function(t){if(!this.treeComponent.selectedNode){this.treeComponent.expandParents(t,!0);var e=this.$tree.find("#tree-link-"+t.id)[0];e&&e.scrollIntoViewIfNeeded()}this.treeComponent.selectNode(t)},e.prototype.expandNode=function(t,e){this.treeComponent.expandNode(t,e)},e.prototype.getAllNodes=function(){return this.treeComponent.getAllNodes()},e.prototype.deselectCurrentNode=function(){this.treeComponent.deselectCurrentNode()},e.prototype.getNodeById=function(t){return this.treeComponent.getNodeById(t)},e.prototype.resize=function(){t.prototype.resize.call(this)},e}(r.a),w=n(1),E=n(8);n.d(e,"a",(function(){return O}));var T=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),v=n(35).ViewingDirection,_=n(35).ViewingHint,O=function(t){function e(e){var n=t.call(this,e)||this;return n.expandFullEnabled=!1,n.isThumbsViewOpen=!1,n.isTreeViewOpen=!1,n.treeSortType=E.c.NONE,n}return T(e,t),e.prototype.create=function(){var e=this;this.setConfig("contentLeftPanel"),t.prototype.create.call(this),this.component.subscribe(s.a.SETTINGS_CHANGED,(function(){e.databind()})),this.component.subscribe(s.a.GALLERY_THUMB_SELECTED,(function(){e.collapseFull()})),this.component.subscribe(s.a.METRIC_CHANGED,(function(){e.extension.isDesktopMetric()||e.isFullyExpanded&&e.collapseFull()})),this.component.subscribe(s.a.ANNOTATIONS,(function(){e.databindThumbsView(),e.databindGalleryView()})),this.component.subscribe(s.a.ANNOTATIONS_CLEARED,(function(){e.databindThumbsView(),e.databindGalleryView()})),this.component.subscribe(s.a.ANNOTATIONS_EMPTY,(function(){e.databindThumbsView(),e.databindGalleryView()})),this.component.subscribe(s.a.CANVAS_INDEX_CHANGED,(function(){e.isFullyExpanded&&e.collapseFull(),e.selectCurrentTreeNode(),e.updateTreeTabBySelection()})),this.component.subscribe(s.a.RANGE_CHANGED,(function(){e.isFullyExpanded&&e.collapseFull(),e.selectCurrentTreeNode(),e.updateTreeTabBySelection()})),this.$tabs=$('<div class="tabs"></div>'),this.$main.append(this.$tabs),this.$treeButton=$('<a class="index tab" tabindex="0">'+this.content.index+"</a>"),this.$tabs.append(this.$treeButton),this.$thumbsButton=$('<a class="thumbs tab" tabindex="0">'+this.content.thumbnails+"</a>"),this.$thumbsButton.prop("title",this.content.thumbnails),this.$tabs.append(this.$thumbsButton),this.$tabsContent=$('<div class="tabsContent"></div>'),this.$main.append(this.$tabsContent),this.$options=$('<div class="options"></div>'),this.$tabsContent.append(this.$options),this.$topOptions=$('<div class="top"></div>'),this.$options.append(this.$topOptions),this.$treeSelect=$('<select aria-label="'+this.content.manifestRanges+'"></select>'),this.$topOptions.append(this.$treeSelect),this.$bottomOptions=$('<div class="bottom"></div>'),this.$options.append(this.$bottomOptions),this.$leftOptions=$('<div class="left"></div>'),this.$bottomOptions.append(this.$leftOptions),this.$rightOptions=$('<div class="right"></div>'),this.$bottomOptions.append(this.$rightOptions),this.$treeViewOptions=$('<div class="treeView"></div>'),this.$leftOptions.append(this.$treeViewOptions),this.$sortByLabel=$('<span class="sort">'+this.content.sortBy+"</span>"),this.$treeViewOptions.append(this.$sortByLabel),this.$sortButtonGroup=$('<div class="btn-group"></div>'),this.$treeViewOptions.append(this.$sortButtonGroup),this.$sortByDateButton=$('<button class="btn" tabindex="0">'+this.content.date+"</button>"),this.$sortButtonGroup.append(this.$sortByDateButton),this.$sortByVolumeButton=$('<button class="btn" tabindex="0">'+this.content.volume+"</button>"),this.$sortButtonGroup.append(this.$sortByVolumeButton),this.$views=$('<div class="views"></div>'),this.$tabsContent.append(this.$views),this.$treeView=$('<div class="treeView"></div>'),this.$views.append(this.$treeView),this.$thumbsView=$('<div class="thumbsView" tabindex="0"></div>'),this.$views.append(this.$thumbsView),this.$galleryView=$('<div class="galleryView"></div>'),this.$views.append(this.$galleryView),this.$treeSelect.hide(),this.$treeSelect.change((function(){e.databindTreeView(),e.selectCurrentTreeNode(),e.updateTreeTabBySelection()})),this.$sortByDateButton.on("click",(function(){e.sortByDate()})),this.$sortByVolumeButton.on("click",(function(){e.sortByVolume()})),this.$treeViewOptions.hide(),this.$treeButton.onPressed((function(){e.openTreeView()})),this.$thumbsButton.onPressed((function(){e.openThumbsView()})),this.setTitle(this.content.title),this.$sortByVolumeButton.addClass("on");var n=this.options.tabOrder;n&&("thumbs"===(n=(n=n.toLowerCase()).replace(/ /g,"")).split(",")[0]?(this.$treeButton.before(this.$thumbsButton),this.$thumbsButton.addClass("first")):this.$treeButton.addClass("first"))},e.prototype.createTreeView=function(){this.treeView=new m(this.$treeView),this.treeView.treeData=this.getTreeData(),this.treeView.setup(),this.databindTreeView();var t=this.extension.helper.getTopRanges();if(t.length>1)for(var e=0;e<t.length;e++){var n=t[e];this.$treeSelect.append('<option value="'+n.id+'">'+w.LanguageMap.getValue(n.getLabel())+"</option>")}this.updateTreeViewOptions()},e.prototype.databind=function(){this.databindThumbsView(),this.databindTreeView(),this.databindGalleryView()},e.prototype.updateTreeViewOptions=function(){var t=this.getTree();t&&(this.isCollection()&&this.extension.helper.treeHasNavDates(t)?this.$treeViewOptions.show():this.$treeViewOptions.hide(),this.$treeSelect.find("option").length?this.$treeSelect.show():this.$treeSelect.hide())},e.prototype.sortByDate=function(){this.treeSortType=E.c.DATE,this.treeView.treeData=this.getTreeData(),this.treeView.databind(),this.selectCurrentTreeNode(),this.$sortByDateButton.addClass("on"),this.$sortByVolumeButton.removeClass("on"),this.resize()},e.prototype.sortByVolume=function(){this.treeSortType=E.c.NONE,this.treeView.treeData=this.getTreeData(),this.treeView.databind(),this.selectCurrentTreeNode(),this.$sortByDateButton.removeClass("on"),this.$sortByVolumeButton.addClass("on"),this.resize()},e.prototype.isCollection=function(){var t=this.getTree();if(t)return t.data.type===w.TreeNodeType.COLLECTION;throw new Error("Tree not available")},e.prototype.databindTreeView=function(){this.treeView&&(this.treeView.treeData=this.getTreeData(),this.treeView.databind(),this.selectCurrentTreeNode())},e.prototype.getTreeData=function(){return{autoExpand:this._isTreeAutoExpanded(),branchNodesExpandOnClick:o.b.getBool(this.config.options.branchNodesExpandOnClick,!0),branchNodesSelectable:o.b.getBool(this.config.options.branchNodesSelectable,!1),helper:this.extension.helper,topRangeIndex:this.getSelectedTopRangeIndex(),treeSortType:this.treeSortType}},e.prototype._isTreeAutoExpanded=function(){var t=o.b.getBool(this.config.options.autoExpandTreeEnabled,!1),e=this.config.options.autoExpandTreeIfFewerThan||0;if(t){var n=this.extension.helper.getFlattenedTree();if(n&&n.length<e)return!0}return!1},e.prototype.updateTreeTabByCanvasIndex=function(){var t=this.extension.helper.getTopRanges();if(t.length>1){var e=this.getCurrentCanvasTopRangeIndex();if(-1===e)return;var n=t[e];this.setTreeTabTitle(w.LanguageMap.getValue(n.getLabel()))}else this.setTreeTabTitle(this.content.index)},e.prototype.setTreeTabTitle=function(t){this.$treeButton.text(t),this.$treeButton.prop("title",t)},e.prototype.updateTreeTabBySelection=function(){var t=null,e=this.extension.helper.getTopRanges();e.length>1&&(t=this.treeView?this.getSelectedTree().text():w.LanguageMap.getValue(e[0].getLabel())),t?this.setTreeTabTitle(t):this.setTreeTabTitle(this.content.index)},e.prototype.getViewingHint=function(){return this.extension.helper.getViewingHint()},e.prototype.getViewingDirection=function(){return this.extension.helper.getViewingDirection()},e.prototype.createThumbsView=function(){this.thumbsView=new g(this.$thumbsView),this.databindThumbsView()},e.prototype.databindThumbsView=function(){if(this.thumbsView){var t,e,n=this.getViewingHint(),i=this.getViewingDirection();!i||i!==v.LEFT_TO_RIGHT&&i!==v.RIGHT_TO_LEFT?n&&n===_.PAGED?(t=this.config.options.twoColThumbWidth,e=this.config.options.twoColThumbHeight):(t=this.config.options.oneColThumbWidth,e=this.config.options.oneColThumbHeight):(t=this.config.options.twoColThumbWidth,e=this.config.options.twoColThumbHeight);var o=this.extension.helper.getThumbs(t,e);i&&i===v.BOTTOM_TO_TOP&&o.reverse();var s=this.extension.annotations;if(s&&s.length)for(var r=function(t){var e=s[t],n=o.filter((function(t){return t.index===e.canvasIndex}))[0];if(n){var i=$.extend(!0,{},n.data);i.searchResults=e.rects.length,n.data=i}},a=0;a<s.length;a++)r(a);this.thumbsView.thumbs=o,this.thumbsView.databind()}},e.prototype.createGalleryView=function(){this.galleryView=new l(this.$galleryView),this.galleryView.galleryData=this.getGalleryData(),this.galleryView.setup(),this.databindGalleryView()},e.prototype.databindGalleryView=function(){this.galleryView&&(this.galleryView.galleryData=this.getGalleryData(),this.galleryView.databind())},e.prototype.getGalleryData=function(){return{helper:this.extension.helper,chunkedResizingThreshold:this.config.options.galleryThumbChunkedResizingThreshold,content:this.config.content,debug:!1,imageFadeInDuration:300,initialZoom:6,minLabelWidth:20,pageModeEnabled:this.isPageModeEnabled(),scrollStopDuration:100,searchResults:this.extension.annotations,sizingEnabled:!0,thumbHeight:this.config.options.galleryThumbHeight,thumbLoadPadding:this.config.options.galleryThumbLoadPadding,thumbWidth:this.config.options.galleryThumbWidth,viewingDirection:this.getViewingDirection()}},e.prototype.isPageModeEnabled=function(){return"function"==typeof this.extension.getMode?o.b.getBool(this.config.options.pageModeEnabled,!0)&&this.extension.getMode().toString()===c.a.page.toString():o.b.getBool(this.config.options.pageModeEnabled,!0)},e.prototype.getSelectedTree=function(){return this.$treeSelect.find(":selected")},e.prototype.getSelectedTopRangeIndex=function(){var t=this.getSelectedTree().index();return-1===t&&(t=0),t},e.prototype.getTree=function(){var t=this.getSelectedTopRangeIndex();return this.extension.helper.getTree(t,E.c.NONE)},e.prototype.toggleFinish=function(){if(t.prototype.toggleFinish.call(this),this.isUnopened){var e=o.b.getBool(this.config.options.treeEnabled,!0),n=o.b.getBool(this.config.options.thumbsEnabled,!0),i=this.getTree();i&&i.nodes.length||(e=!1),e&&n||this.$tabs.hide(),n&&this.defaultToThumbsView()?this.openThumbsView():e&&this.openTreeView()}},e.prototype.defaultToThumbsView=function(){var t=o.b.getBool(this.config.options.defaultToTreeEnabled,!1),e=this.config.options.defaultToTreeIfGreaterThan||0,n=this.getTree();return!(t&&n&&n.nodes.length>e)},e.prototype.expandFullStart=function(){t.prototype.expandFullStart.call(this),this.component.publish(s.a.LEFTPANEL_EXPAND_FULL_START)},e.prototype.expandFullFinish=function(){t.prototype.expandFullFinish.call(this),this.$treeButton.hasClass("on")?this.openTreeView():this.$thumbsButton.hasClass("on")&&this.openThumbsView(),this.component.publish(s.a.LEFTPANEL_EXPAND_FULL_FINISH)},e.prototype.collapseFullStart=function(){t.prototype.collapseFullStart.call(this),this.component.publish(s.a.LEFTPANEL_COLLAPSE_FULL_START)},e.prototype.collapseFullFinish=function(){t.prototype.collapseFullFinish.call(this),this.$thumbsButton.hasClass("on")&&this.openThumbsView(),this.component.publish(s.a.LEFTPANEL_COLLAPSE_FULL_FINISH)},e.prototype.openTreeView=function(){this.isTreeViewOpen=!0,this.isThumbsViewOpen=!1,this.treeView||this.createTreeView(),this.$treeButton.addClass("on"),this.$thumbsButton.removeClass("on"),this.treeView.show(),this.thumbsView&&this.thumbsView.hide(),this.galleryView&&this.galleryView.hide(),this.updateTreeViewOptions(),this.selectCurrentTreeNode(),this.resize(),this.treeView.resize(),this.component.publish(s.a.OPEN_TREE_VIEW)},e.prototype.openThumbsView=function(){this.isTreeViewOpen=!1,this.isThumbsViewOpen=!0,this.thumbsView||this.createThumbsView(),this.isFullyExpanded&&!this.galleryView&&this.createGalleryView(),this.$treeButton.removeClass("on"),this.$thumbsButton.addClass("on"),this.treeView&&this.treeView.hide(),this.$treeSelect.hide(),this.$treeViewOptions.hide(),this.resize(),this.isFullyExpanded?(this.thumbsView.hide(),this.galleryView&&this.galleryView.show(),this.galleryView&&this.galleryView.resize()):(this.galleryView&&this.galleryView.hide(),this.thumbsView.show(),this.thumbsView.resize()),this.component.publish(s.a.OPEN_THUMBS_VIEW)},e.prototype.selectTopRangeIndex=function(t){this.$treeSelect.prop("selectedIndex",t)},e.prototype.getCurrentCanvasTopRangeIndex=function(){var t=-1,e=this.extension.getCurrentCanvasRange();return e&&(t=Number(e.path.split("/")[0])),t},e.prototype.selectCurrentTreeNode=function(){"uv-openseadragon-extension"===this.extension.name?this.selectCurrentTreeNodeByCanvas():this.selectCurrentTreeNodeByRange()},e.prototype.selectCurrentTreeNodeByRange=function(){if(this.treeView){var t=this.extension.helper.getCurrentRange(),e=null;t&&t.treeNode&&(e=this.treeView.getNodeById(t.treeNode.id)),e?this.treeView.selectNode(e):this.selectTreeNodeByManifest()}},e.prototype.selectCurrentTreeNodeByCanvas=function(){if(this.treeView){var t=null,e=this.getCurrentCanvasTopRangeIndex(),n=e===this.getSelectedTopRangeIndex(),i=null;-1!==e&&(i=this.extension.getCurrentCanvasRange())&&i.treeNode&&(t=this.treeView.getNodeById(i.treeNode.id)),t&&n?this.treeView.selectNode(t):((i=this.extension.helper.getCurrentRange())&&i.treeNode&&(t=this.treeView.getNodeById(i.treeNode.id)),t?this.treeView.selectNode(t):this.selectTreeNodeByManifest())}},e.prototype.selectTreeNodeByManifest=function(){var t=this,e=this.extension.helper.collectionIndex,n=this.extension.helper.manifestIndex,i=this.treeView.getAllNodes(),o=!1;i.map((function(i){i.isCollection()&&i.data.index===e&&(t.treeView.selectNode(i),t.treeView.expandNode(i,!0),o=!0),i.isManifest()&&i.data.index===n&&(t.treeView.selectNode(i),o=!0)})),o||this.treeView.deselectCurrentNode()},e.prototype.resize=function(){t.prototype.resize.call(this),this.$tabsContent.height(this.$main.height()-(this.$tabs.is(":visible")?this.$tabs.height():0)-this.$tabsContent.verticalPadding()),this.$views.height(this.$tabsContent.height()-this.$options.outerHeight())},e}(p.a)}}]);